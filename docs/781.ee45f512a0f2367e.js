"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[781],{2781:(U,N,h)=>{h.r(N),h.d(N,{TF2Painter:()=>X});var D=h(4882),a=h(8872),H=h(4355),A=h(8868),L=h(1922),b=h(2843),Y=h(4615);class X extends H.TH2Painter{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??a.clTF2}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(e){if(!e||this.getClassName()!==e._typename)return!1;delete e.evalPar;const t=this.getHisto();if(this.webcanv_hist){const i=this.getPadPainter()?.findInPrimitives("Func",a.clTH2F);i&&this.updateAxes(t,i,this.getFramePainter())}return this.$func=e,this.createTF2Histogram(e,t),this.scanContent(),!0}redraw(e){return!this._use_saved_points&&("logx"===e||"logy"===e||"zoom"===e)&&(this.createTF2Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(e)}createTF2Histogram(e,t){let i=e.fSave.length-6;i>0&&i!==(e.fSave[i+4]+1)*(e.fSave[i+5]+1)&&(i=0),this._use_saved_points=i>0&&(a.settings.PreferSavedPoints||this.force_saved);const o=this.getFramePainter(),c=this.getPadPainter()?.getRootPad(!0),y=c?.fLogx,u=c?.fLogy,s=o?.getGrFuncs(this.second_x,this.second_y);let f=e.fXmin,m=e.fXmax,T=e.fYmin,C=e.fYmax;s?.zoom_xmin!==s?.zoom_xmax&&(f=Math.min(f,s.zoom_xmin),m=Math.max(m,s.zoom_xmax)),s?.zoom_ymin!==s?.zoom_ymax&&(T=Math.min(T,s.zoom_ymin),C=Math.max(C,s.zoom_ymax));const B=(r,x)=>{t.fNcells!==(r+2)*(x+2)&&(t.fNcells=(r+2)*(x+2),t.fArray=new Float32Array(t.fNcells)),t.fArray.fill(0),t.fXaxis.fNbins=r,t.fXaxis.fXbins=[],t.fYaxis.fNbins=x,t.fYaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){const r=Math.max(e.fNpx,20),x=Math.max(e.fNpy,20);let n=!1;!e.evalPar&&!(0,A.proivdeEvalPar)(e)&&(n=!0),B(r,x),t.fXaxis.fXmin=f,t.fXaxis.fXmax=m,t.fYaxis.fXmin=T,t.fYaxis.fXmax=C,y&&(0,A.produceTAxisLogScale)(t.fXaxis,r,f,m),u&&(0,A.produceTAxisLogScale)(t.fYaxis,x,T,C);for(let M=0;M<x&&!n;++M)for(let l=0;l<r&&!n;++l){const F=t.fXaxis.GetBinCenter(l+1),P=t.fYaxis.GetBinCenter(M+1);let d=0;try{d=e.evalPar(F,P)}catch{n=!0}n||t.setBinContent(t.getBin(l+1,M+1),Number.isFinite(d)?d:0)}n&&(this._fail_eval=!0),n&&i>6&&(this._use_saved_points=!0)}if(this._use_saved_points){let z=function(v,S){if(v<r||v>x||P<=0||S<n||S>M||d<=0)return 0;const _=Math.min(l-1,Math.floor((v-r)/P)),g=Math.min(F-1,Math.floor((S-n)/d)),O=(v-(r+_*P))/P,p=(S-(n+g*d))/d;return(1-O)*(1-p)*e.fSave[g*(l+1)+_]+O*(1-p)*e.fSave[g*(l+1)+_+1]+O*p*e.fSave[(g+1)*(l+1)+_+1]+(1-O)*p*e.fSave[(g+1)*(l+1)+_]};const r=e.fSave[i],x=e.fSave[i+1],n=e.fSave[i+2],M=e.fSave[i+3],l=Math.round(e.fSave[i+4]),F=Math.round(e.fSave[i+5]),P=(x-r)/l,d=(M-n)/F;B(e.fNpx,e.fNpy),t.fXaxis.fXmin=e.fXmin,t.fXaxis.fXmax=e.fXmax,t.fYaxis.fXmin=e.fYmin,t.fYaxis.fXmax=e.fYmax;for(let v=0;v<e.fNpy;++v){const S=t.fYaxis.GetBinCenter(v+1);for(let _=0;_<e.fNpx;++_){const E=z(t.fXaxis.GetBinCenter(_+1),S);t.setBinContent(t.getBin(_+1,v+1),Number.isFinite(E)?E:0)}}}return t.fName="Func",(0,a.setHistogramTitle)(t,e.fTitle),t.fMinimum=e.fMinimum,t.fMaximum=e.fMaximum,t.fLineColor=e.fLineColor,t.fLineStyle=e.fLineStyle,t.fLineWidth=e.fLineWidth,t.fFillColor=e.fFillColor,t.fFillStyle=e.fFillStyle,t.fMarkerColor=e.fMarkerColor,t.fMarkerStyle=e.fMarkerStyle,t.fMarkerSize=e.fMarkerSize,t.fBits|=a.kNoStats,t}extractAxesProperties(e){super.extractAxesProperties(e);const t=this.$func,i=t?.fSave.length??0;i>6&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,t.fSave[i-6]),this.xmax=Math.max(this.xmax,t.fSave[i-5]),this.ymin=Math.min(this.ymin,t.fSave[i-4]),this.ymax=Math.max(this.ymax,t.fSave[i-3])),t&&(this.xmin=Math.min(this.xmin,t.fXmin),this.xmax=Math.max(this.xmax,t.fXmax),this.ymin=Math.min(this.ymin,t.fYmin),this.ymax=Math.max(this.ymax,t.fYmax))}getTF2Tooltips(e){const t=[this.getObjectHint()],i=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!i||!(0,a.isFunc)(this.$func?.evalPar))return t.push("grx = "+e.x,"gry = "+e.y),t;const o=i.revertAxis("x",e.x),c=i.revertAxis("y",e.y);let y=0,u=!1;try{y=this.$func.evalPar(o,c)}catch{u=!0}return t.push("x = "+i.axisAsText("x",o),"y = "+i.axisAsText("y",c),"value = "+(u?"<fail>":(0,b.lg)(y,a.gStyle.fStatFormat))),t}processTooltipEvent(e){if(this._use_saved_points)return super.processTooltipEvent(e);let t=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!e)return t?.remove(),null;const i={name:this.$func?.fName,title:this.$func?.fTitle,x:e.x,y:e.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF2Tooltips(e),exact:!0,menu:!0};return e.disabled?t.remove():(t.empty()&&(t=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),t.attr("cx",e.x).attr("cy",e.y).call(this.lineatt?.func)),i}fillWebObjectOptions(e){e.fcust=this._fail_eval?"func_fail":""}static draw(e,t,i){return(0,D.A)(function*(){(0,a.isStr)(i)||(i="");let o=i.indexOf(";webcanv_hist"),c=!1,y=!1;o>=0&&(c=!0,i=i.slice(0,o)),o=i.indexOf(";force_saved"),o>=0&&(y=!0,i=i.slice(0,o));const u=new b.nC(i);u.empty()?i="cont3":"SAME"===u.opt&&(i="cont2 same");const s=(0,a.isStr)(i)?i.toUpperCase():"";let f;("SAMECOLORZ"===s||"SAMECOLOR"===s||"SAMECOLZ"===s)&&(i="samecol"),(0===i.indexOf("same")||0===i.indexOf("SAME"))&&((0,L.Nn)(e)||(i="A_ADJUST_FRAME_"+i.slice(4))),c&&(f=new L.JW(e).getPadPainter()?.findInPrimitives("Func",a.clTH2F)),f||(f=(0,a.createHistogram)(a.clTH2F,20,20),f.fBits|=a.kNoStats);const m=new X(e,f);return m.$func=t,m.webcanv_hist=c,m.force_saved=y,m.createTF2Histogram(t,f),Y.mf._drawHist(m,i)})()}}}}]);
//# sourceMappingURL=781.ee45f512a0f2367e.js.map