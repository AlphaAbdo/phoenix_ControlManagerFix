"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[103],{6103:(L,w,P)=>{P.r(w),P.d(w,{TRatioPlotPainter:()=>T});var g=P(5072),p=P(8872),D=P(9640),v=P(4483),F=P(801);class T extends D.JW{setGridsRange(r,t,n,e,s){const i=this.getObject();if(r===t){const a=this.getPadPainter()?.findPainterFor(i.fLowerPad,"lower_pad",p.clTPad)?.getFramePainter()?.x_handle;if(!a)return;0===r?(r=a.full_min,t=a.full_max):(r=a.scale_min,t=a.scale_max)}i.fGridlines.forEach(a=>{a.fX1=r,a.fX2=t});const o=Math.min(i.fGridlines.length,i.fGridlinePositions.length);for(let a=0;a<o;++a){const _=i.fGridlinePositions[a],f=i.fGridlines[a];"ignorey"!==n&&(f.$do_not_draw=n!==e&&(_<n||_>e),f.fY1=f.fY2=_),s?.findPainterFor(f)?.redraw()}}configureInteractive(){const r=this.getObject(),t=this.getPadPainter(),n=t.findPainterFor(r.fUpperPad,"upper_pad",p.clTPad),e=n?.getFramePainter(),s=t.findPainterFor(r.fLowerPad,"lower_pad",p.clTPad),i=s?.getFramePainter();!n||!s||(s.forEachPainterInPad(o=>{(0,p.isFunc)(o?.testEditable)&&o.testEditable(!1)}),this.setGridsRange(i.scale_xmin,i.scale_xmax,i.scale_ymin,i.scale_ymax,s),(!n._ratio_interactive||!s._ratio_interactive)&&(n._ratio_interactive=!0,s._ratio_interactive=!0,e.o_zoom=e.zoom,e._ratio_low_fp=i,e._ratio_painter=this,e.zoom=function(o,a,_,f,c,d){return this.o_zoom(o,a,_,f,c,d).then(h=>(this._ratio_painter.setGridsRange(e.scale_xmin,e.scale_xmax,"ignory"),this._ratio_low_fp.o_zoom(e.scale_xmin,e.scale_xmax).then(()=>h)))},e.o_sizeChanged=e.sizeChanged,e.sizeChanged=function(){this.o_sizeChanged(),this._ratio_low_fp.fX1NDC=this.fX1NDC,this._ratio_low_fp.fX2NDC=this.fX2NDC,this._ratio_low_fp.o_sizeChanged()},i.o_zoom=i.zoom,i._ratio_up_fp=e,i._ratio_painter=this,i.zoom=function(o,a,_,f,c,d){return o===a?(o=e.xmin,a=e.xmax):(o<e.xmin&&(o=e.xmin),a>e.xmax&&(a=e.xmax)),this._ratio_painter.setGridsRange(o,a,_,f),this._ratio_up_fp.o_zoom(o,a).then(()=>this.o_zoom(o,a,_,f,c,d))},i.o_sizeChanged=i.sizeChanged,i.sizeChanged=function(){this.o_sizeChanged(),this._ratio_up_fp.fX1NDC=this.fX1NDC,this._ratio_up_fp.fX2NDC=this.fX2NDC,this._ratio_up_fp.o_sizeChanged()}))}redrawOld(){var r=this;return(0,g.A)(function*(){const t=r.getObject(),n=r.getPadPainter(),e=n.findPainterFor(t.fTopPad,"top_pad",p.clTPad),s=n.getRootPad(),i=0===s.fFrameFillStyle?1:0,o=s.fTickx||i,a=s.fTicky||i;e?.disablePadDrawing();const _=n.findPainterFor(t.fUpperPad,"upper_pad",p.clTPad),f=_?.getMainPainter(),c=_?.getFramePainter(),d=n.findPainterFor(t.fLowerPad,"lower_pad",p.clTPad),h=d?.getMainPainter(),m=d?.getFramePainter();let C=Promise.resolve(!0);if(_&&f&&c&&m&&!_._ratio_configured){_._ratio_configured=!0,f.options.Axis=0;const u=f.getHisto();u.fYaxis.$use_top_pad=!0,u.fXaxis.fLabelSize=0,u.fXaxis.fTitle="",_.getRootPad().fTickx=o,_.getRootPad().fTicky=a,C=_.redrawPad()}return C.then(()=>{if(!d||!h||!m||!c||d._ratio_configured)return r;d._ratio_configured=!0,h.options.Axis=0;const u=h.getHisto();u.fXaxis.fTitle="x",u.fXaxis.$use_top_pad=!0,u.fYaxis.$use_top_pad=!0,d.getRootPad().fTickx=o,d.getRootPad().fTicky=a;const z=[];return t.fGridlinePositions.length>0&&t.fGridlines.length<t.fGridlinePositions.length&&t.fGridlinePositions.forEach(x=>{let E=!1;if(t.fGridlines.forEach(l=>{l.fY1===l.fY2&&Math.abs(l.fY1-x)<1e-6&&(E=!0)}),!E){const l=(0,p.create)(p.clTLine);l.fX1=c.scale_xmin,l.fX2=c.scale_xmax,l.fY1=l.fY2=x,l.fLineStyle=2,t.fGridlines.push(l),z.push(F.TLinePainter.draw(d,l))}}),Promise.all(z).then(()=>m.zoom(c.scale_xmin,c.scale_xmax))})})()}redraw(){var r=this;return(0,g.A)(function*(){const t=r.getObject(),n=r.getPadPainter();if(void 0===r.$oldratio&&(r.$oldratio=!!n.findPainterFor(t.fTopPad,"top_pad",p.clTPad)),n.$userInteractive=()=>r.configureInteractive(),r.$oldratio)return r.redrawOld();const e=n.getRootPad(),s=0===e.fFrameFillStyle?1:0,i=e.fTickx||s,o=e.fTicky||s;return t.fTopPad.$disable_drawing=!0,t.fUpperPad.$ratio_pad="up",t.fUpperPad.fTickx=i,t.fUpperPad.fTicky=o,t.fLowerPad.$ratio_pad="low",t.fLowerPad.fTickx=i,t.fLowerPad.fTicky=o,r})()}static draw(r,t,n){return(0,g.A)(function*(){const e=new T(r,t,n);return(0,v.ensureTCanvas)(e,!1).then(()=>e.redraw())})()}}}}]);
//# sourceMappingURL=103.c39e9accc55c21b3.js.map