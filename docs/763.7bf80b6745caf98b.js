"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[763],{5763:(Yt,Q,D)=>{D.r(Q),D.d(Q,{TGraph2DPainter:()=>$});var R=D(5072),Z=D(8872),Nt=D(2843),ct=D(9640),dt=D(4355),ut=D(9997),C=D(7615),V=D(8537);function tt(z){let i=z[0];for(let h=1;h<z.length;++h)i=Math.max(i,z[h]);return i}function it(z){let i=z[0];for(let h=1;h<z.length;++h)i=Math.min(i,z[h]);return i}class mt{constructor(i){this.fGraph2D=i,this.fX=i.fX,this.fY=i.fY,this.fZ=i.fZ,this.fNpoints=i.fNpoints,this.fZout=0,this.fNdt=0,this.fNhull=0,this.fHullPoints=null,this.fXN=null,this.fYN=null,this.fOrder=null,this.fDist=null,this.fPTried=null,this.fNTried=null,this.fMTried=null,this.fInit=!1,this.fXNmin=0,this.fXNmax=0,this.fYNmin=0,this.fYNmax=0,this.fXoffset=0,this.fYoffset=0,this.fXScaleFactor=0,this.fYScaleFactor=0,this.SetMaxIter()}Initialize(){this.fInit||(this.CreateTrianglesDataStructure(),this.FindHull(),this.fInit=!0)}ComputeZ(i,h){this.Initialize();const s=(i+this.fXoffset)*this.fXScaleFactor,t=(h+this.fYoffset)*this.fYScaleFactor;let l=this.Interpolate(s,t);return 0===l&&(l=this.Interpolate(s+1e-4,t)),l}CreateTrianglesDataStructure(){const i=tt(this.fGraph2D.fX),h=tt(this.fGraph2D.fY),s=it(this.fGraph2D.fX),t=it(this.fGraph2D.fY);this.fXoffset=-(i+s)/2,this.fYoffset=-(h+t)/2,this.fXScaleFactor=1/(i-s),this.fYScaleFactor=1/(h-t),this.fXNmax=(i+this.fXoffset)*this.fXScaleFactor,this.fXNmin=(s+this.fXoffset)*this.fXScaleFactor,this.fYNmax=(h+this.fYoffset)*this.fYScaleFactor,this.fYNmin=(t+this.fYoffset)*this.fYScaleFactor,this.fXN=new Array(this.fNpoints+1),this.fYN=new Array(this.fNpoints+1);for(let l=0;l<this.fNpoints;l++)this.fXN[l+1]=(this.fX[l]+this.fXoffset)*this.fXScaleFactor,this.fYN[l+1]=(this.fY[l]+this.fYoffset)*this.fYScaleFactor;this.fPTried=[],this.fNTried=[],this.fMTried=[]}Enclose(i,h,s,t){const l=[this.fXN[i],this.fXN[h],this.fXN[s],this.fXN[i]],r=[this.fYN[i],this.fYN[h],this.fYN[s],this.fYN[i]],o=this.fXN[t],n=this.fYN[t];let _=0,X=l.length-1,m=!1;for(;_<l.length;++_)(r[_]<n&&r[X]>=n||r[X]<n&&r[_]>=n)&&l[_]+(n-r[_])/(r[X]-r[_])*(l[X]-l[_])<o&&(m=!m),X=_;return m}FileIt(i,h,s){let t,l,r=i,o=h,n=s;do{t=!1,o>r&&(l=r,r=o,o=l,t=!0),n>o&&(l=o,o=n,n=l,t=!0)}while(t);this.fNdt++,this.fPTried.push(r),this.fNTried.push(o),this.fMTried.push(n)}FindAllTriangles(){if(this.fAllTri)return;this.fAllTri=!0;let i,h,s,t,l,r,o,n,_,X,m,N,e,a,c,f,d,T,y,u,Y,M,x,E,g,P=0,p=0,w=0;const I=[!1,!1,!1],O=1e-4;for(this.Initialize(),i=0,h=0,g=1;g<=this.fNhull;g++)i+=this.fXN[this.fHullPoints[g-1]],h+=this.fYN[this.fHullPoints[g-1]];for(i=i/this.fNhull+O,h=h/this.fNhull+O,this.Interpolate(i,h),f=1;f<=this.fNdt;){for(T=this.fPTried[f-1],y=this.fNTried[f-1],u=this.fMTried[f-1],I[0]=!1,I[1]=!1,I[2]=!1,d=1;d<=this.fNdt;d++)d!==f&&(Y=this.fPTried[d-1],M=this.fNTried[d-1],x=this.fMTried[d-1],T===Y&&y===M||T===Y&&y===x||T===M&&y===x?I[0]=!0:T===Y&&u===M||T===Y&&u===x||T===M&&u===x?I[1]=!0:(y===Y&&u===M||y===Y&&u===x||y===M&&u===x)&&(I[2]=!0));for(E=1;E<=3;E++)I[E-1]||(1===E?(P=T,p=y,w=u):2===E?(P=T,p=u,w=y):3===E&&(P=y,p=u,w=T),s=(this.fXN[P]+this.fXN[p])/2,t=(this.fYN[P]+this.fYN[p])/2,o=this.fXN[P]-this.fXN[p],n=this.fYN[P]-this.fYN[p],_=n,X=-o,a=Math.sqrt(_*_+X*X),_/=a,X/=a,m=this.fXN[w]-s,N=this.fYN[w]-t,e=m*_+N*X,e>0&&(_=-_,X=-X),c=Math.abs(Math.max(O*s,O*t)),l=s+_*c,r=t+X*c,this.Interpolate(l,r));f++}}FindHull(){this.fHullPoints||(this.fHullPoints=new Array(this.fNpoints));let i=0;for(let h=1;h<=this.fNpoints;h++)this.InHull(h,h)||(i++,this.fHullPoints[i-1]=h);this.fNhull=i}InHull(i,h){let s,t,l,r,o,n,_,X,m,N,e,a,c,f,d,T,y,u,Y,M,x,P=!1;const p=this.fXN[i],E=this.fYN[i];for(o=this.fNhull>0?this.fNhull:this.fNpoints,s=1,t=2,s===h?(s=t,t++):t===h&&t++,m=p-this.fXN[s],a=E-this.fYN[s],N=p-this.fXN[t],c=E-this.fYN[t],Y=Math.atan2(a,m),M=Math.atan2(c,N),x=Y-M-Math.floor((Y-M)/(2*Math.PI))*Math.PI*2,x<0&&(x+=2*Math.PI),n=x,l=1;l<=o;l++)if(r=this.fNhull>0?this.fHullPoints[l-1]:l,r!==s&&r!==t&&r!==h&&(m=p-this.fXN[s],a=E-this.fYN[s],N=p-this.fXN[t],c=E-this.fYN[t],e=p-this.fXN[r],f=E-this.fYN[r],_=N*a-m*c,X=m*c-N*a,_*X!=0&&(d=(N*f-e*c)/_,T=(m*f-e*a)/X,d<0||T<0))){if(y=(m*e+a*f)/Math.sqrt(m*m+a*a),u=(N*e+c*f)/Math.sqrt(N*N+c*c),y>u?(s=r,Y=Math.atan2(f,e),M=Math.atan2(c,N)):(t=r,Y=Math.atan2(a,m),M=Math.atan2(f,e)),x=Y-M-Math.floor((Y-M)/(2*Math.PI))*Math.PI*2,x<0&&(x+=2*Math.PI),(x-Math.PI)*(n-Math.PI)<0)return P=!0,P;n=x}return P}InterpolateOnPlane(i,h,s,t){let l,r,o=i,n=h,_=s;do{r=!1,n>o&&(l=o,o=n,n=l,r=!0),_>n&&(l=n,n=_,_=l,r=!0)}while(r);const X=this.fXN[o],m=this.fXN[n],N=this.fXN[_],e=this.fYN[o],a=this.fYN[n],c=this.fYN[_],f=this.fZ[o-1],d=this.fZ[n-1],T=this.fZ[_-1],y=(f*(a-c)+d*(c-e)+T*(e-a))/(X*(a-c)+m*(c-e)+N*(e-a)),u=(f*(m-N)+d*(N-X)+T*(X-m))/(e*(m-N)+a*(N-X)+c*(X-m));return y*this.fXN[t]+u*this.fYN[t]+(f-y*X-u*e)}Interpolate(i,h){let s,t,l,r,o,n,_,X,m,N,e,a,c,f,d,T,y,u,Y,M,w,I,O,b,v,H,L,st,et,ft,ht,K,U,rt,nt,S,j,q,B,G,J,at,lt,x=0,P=0,p=0,E=0,g=0;const k=[0,0,0],A=[0,0,0];if(this.Initialize(),this.fOrder||(this.fOrder=new Array(this.fNpoints),this.fDist=new Array(this.fNpoints)),this.fXN[0]=i,this.fYN[0]=h,s=this.fZout,l=0,i>this.fXNmax||i<this.fXNmin||h>this.fYNmax||h<this.fYNmin)return s;for(t=1;t<=this.fNdt;t++)if(r=this.fPTried[t-1],o=this.fNTried[t-1],n=this.fMTried[t-1],this.Enclose(r,o,n,0))return s=this.InterpolateOnPlane(r,o,n,0),s;const ot=this.InHull(0,-1);if(!ot)return s;for(t=1;t<=this.fNpoints;t++)w=this.fXN[t],I=this.fYN[t],this.fDist[t-1]=Math.sqrt((i-w)*(i-w)+(h-I)*(h-I));for(function Xt(z,i,h){const s=new Array(z);for(let t=0;t<z;++t)s[t]={v:i[t],i:t};s.sort((t,l)=>t.v<l.v?-1:t.v>l.v?1:0);for(let t=0;t<z;++t)h[t]=s[t].i}(this.fNpoints,this.fDist,this.fOrder),t=0;t<this.fNpoints;t++)this.fOrder[t]++;for(m=3;m<=this.fNpoints;m++)for(n=this.fOrder[m-1],X=2;X<=m-1;X++)for(o=this.fOrder[X-1],_=1;_<=X-1;_++){let F=!1;if(r=this.fOrder[_-1],l>this.fMaxIter)return s;if(l++,O=Math.sqrt((this.fXN[r]-this.fXN[o])**2+(this.fYN[r]-this.fYN[o])**2),b=Math.sqrt((this.fXN[r]-this.fXN[n])**2+(this.fYN[r]-this.fYN[n])**2),v=Math.sqrt((this.fXN[o]-this.fXN[n])**2+(this.fYN[o]-this.fYN[n])**2),!(O+b<=v||O+v<=b||b+v<=O)&&this.Enclose(r,o,n,0)){for(x=0,e=1;e<=this.fNpoints;e++)if(e!==r&&e!==o&&e!==n){for(N=1;N<=this.fNpoints;N++)if(this.fOrder[N-1]===e){if(!(N<_||N<X||N<m))break;if(this.Enclose(r,o,n,e)){F=!0;break}}if(F)break;if((this.fXN[r]-this.fXN[e])*(this.fYN[r]-this.fYN[o])==(this.fYN[r]-this.fYN[e])*(this.fXN[r]-this.fXN[o])?(T=r,y=o):(this.fXN[r]-this.fXN[e])*(this.fYN[r]-this.fYN[n])==(this.fYN[r]-this.fYN[e])*(this.fXN[r]-this.fXN[n])?(T=r,y=n):(this.fXN[o]-this.fXN[e])*(this.fYN[o]-this.fYN[n])==(this.fYN[o]-this.fYN[e])*(this.fXN[o]-this.fXN[n])?(T=o,y=n):(T=0,y=0),0!==T){if(this.fXN[T]!==this.fXN[y]){if((this.fXN[e]-this.fXN[T])*(this.fXN[e]-this.fXN[y])<0){F=!0;break}(this.fXN[e]-this.fXN[T])*(this.fXN[e]-this.fXN[y])==0&&console.warn(`Interpolate Two of these three points are coincident ${T} ${y} ${e}`)}else{if((this.fYN[e]-this.fYN[T])*(this.fYN[e]-this.fYN[y])<0){F=!0;break}(this.fYN[e]-this.fYN[T])*(this.fYN[e]-this.fYN[y])==0&&console.warn(`Interpolate Two of these three points are coincident ${T} ${y} ${e}`)}continue}if(F)break;for(a=n,f=r,d=o,k[0]=this.fXN[r]-this.fXN[e],A[0]=this.fYN[r]-this.fYN[e],k[1]=this.fXN[o]-this.fXN[e],A[1]=this.fYN[o]-this.fYN[e],k[2]=this.fXN[n]-this.fXN[e],A[2]=this.fYN[n]-this.fYN[e],N=1;N<=3;N++)if(S=k[N-1],j=k[N%3],q=k[(N+1)%3],B=A[N-1],G=A[N%3],J=A[(N+1)%3],at=(J*j-q*G)*(B*j-S*G),lt=(J*S-q*B)*(G*S-j*B),at>=0&&lt>=0){1===N?(a=n,f=r,d=o):2===N?(a=r,f=o,d=n):(a=o,f=n,d=r);break}if(U=((this.fXN[a]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[a]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))/Math.sqrt(((this.fXN[a]-this.fXN[f])*(this.fXN[a]-this.fXN[f])+(this.fYN[a]-this.fYN[f])*(this.fYN[a]-this.fYN[f]))*((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))),rt=((this.fXN[d]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[d]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))/Math.sqrt(((this.fXN[d]-this.fXN[f])*(this.fXN[d]-this.fXN[f])+(this.fYN[d]-this.fYN[f])*(this.fYN[d]-this.fYN[f]))*((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))),nt=((this.fXN[d]-this.fXN[f])*(this.fXN[a]-this.fXN[f])+(this.fYN[d]-this.fYN[f])*(this.fYN[a]-this.fYN[f]))/Math.sqrt(((this.fXN[d]-this.fXN[f])*(this.fXN[d]-this.fXN[f])+(this.fYN[d]-this.fYN[f])*(this.fYN[d]-this.fYN[f]))*((this.fXN[a]-this.fXN[f])*(this.fXN[a]-this.fXN[f])+(this.fYN[a]-this.fYN[f])*(this.fYN[a]-this.fYN[f]))),!(U>rt||U>nt)){if(st=Math.sqrt((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f])),et=Math.sqrt((this.fXN[e]-this.fXN[d])*(this.fXN[e]-this.fXN[d])+(this.fYN[e]-this.fYN[d])*(this.fYN[e]-this.fYN[d])),ft=Math.sqrt((this.fXN[a]-this.fXN[f])*(this.fXN[a]-this.fXN[f])+(this.fYN[a]-this.fYN[f])*(this.fYN[a]-this.fYN[f])),ht=Math.sqrt((this.fXN[a]-this.fXN[d])*(this.fXN[a]-this.fXN[d])+(this.fYN[a]-this.fYN[d])*(this.fYN[a]-this.fYN[d])),H=((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[d])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[d]))/st/et,L=((this.fXN[a]-this.fXN[f])*(this.fXN[a]-this.fXN[d])+(this.fYN[a]-this.fYN[f])*(this.fYN[a]-this.fYN[d]))/ft/ht,K=H*Math.sqrt(1-L*L)+L*Math.sqrt(1-H*H),K<-1e-6){F=!0;break}Math.abs(K)<=1e-6&&(x++,P=e,p=a,E=f,g=d)}}if(!F)return x>0?(c=P,a=p,f=E,d=g,this.fZ[f-1]+this.fZ[d-1]>this.fZ[c-1]+this.fZ[a-1]?(u=r,Y=o,M=n,this.FileIt(r,o,n),this.FileIt(c,f,d)):(u=a,Y=c,M=this.Enclose(a,c,f,0)?f:d,this.FileIt(a,c,f),this.FileIt(a,c,d))):(this.FileIt(r,o,n),u=r,Y=o,M=n),s=this.InterpolateOnPlane(u,Y,M,0),s}}return ot&&console.error(`Interpolate Point outside hull when expected inside: this point could be dodgy ${i}  ${h} ${l}`),s}SetMaxIter(i=1e5){this.fAllTri=!1,this.fMaxIter=i}SetMarginBinsContent(i){this.fZout=i}}function W(z){let i=Math.floor(z.index/this.nvertex);if(i<0||i>=this.index.length)return null;const h=n=>n*n;i=this.index[i];const s=this.fp,t=this.graph;let l=s.grx(t.fX[i]),r=s.gry(t.fY[i]),o=s.grz(t.fZ[i]);if(this.check_next&&i+1<t.fX.length){const n=z.point,_=s.grx(t.fX[i+1]),X=s.gry(t.fY[i+1]),m=s.grz(t.fZ[i+1]);h(n.x-_)+h(n.y-X)+h(n.z-m)<h(n.x-l)+h(n.y-r)+h(n.z-o)&&(l=_,r=X,o=m,i++)}return{x1:l-this.scale0,x2:l+this.scale0,y1:r-this.scale0,y2:r+this.scale0,z1:o-this.scale0,z2:o+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+i,"x: "+s.axisAsText("x",t.fX[i]),"y: "+s.axisAsText("y",t.fY[i]),"z: "+s.axisAsText("z",t.fZ[i])]}}class $ extends ct.JW{decodeOptions(i,h){const s=new Nt.nC(i);this.options||(this.options={});const t=this.options,l=this.getObject();s.check("FILL_","color")&&l&&(l.fFillColor=s.color),s.check("LINE_","color")&&l&&(l.fLineColor=s.color),s.check("SAME"),t.Triangles=s.check("TRI1")?11:s.check("TRI2")?10:s.check("TRIW")?1:s.check("TRI")?2:0,t.Line=s.check("LINE"),t.Error=s.check("ERR")&&(this.matchObjectType(Z.clTGraph2DErrors)||this.matchObjectType(Z.clTGraph2DAsymmErrors)),s.check("P0COL")?t.Color=t.Circles=t.Markers=!0:(t.Color=s.check("COL"),t.Circles=s.check("P0"),t.Markers=s.check("P")),t.Markers||(t.Color=!1),(t.Color||t.Triangles>=10)&&(t.Zscale=s.check("Z")),t.isAny=function(){return this.Markers||this.Error||this.Circles||this.Line||this.Triangles},t.isAny()?(t.Axis="lego2",t.Zscale&&(t.Axis+="z")):t.Axis=i,this.storeDrawOpt(i)}createHistogram(){const i=this.getObject(),h=this.matchObjectType(Z.clTGraph2DAsymmErrors);let s=i.fX[0],t=s,l=i.fY[0],r=l,o=i.fZ[0],n=o;for(let Y=0;Y<i.fNpoints;++Y){const M=i.fX[Y],x=i.fY[Y],P=i.fZ[Y];this.options.Error?(s=Math.min(s,M-(h?i.fEXlow[Y]:i.fEX[Y])),t=Math.max(t,M+(h?i.fEXhigh[Y]:i.fEX[Y])),l=Math.min(l,x-(h?i.fEYlow[Y]:i.fEY[Y])),r=Math.max(r,x+(h?i.fEYhigh[Y]:i.fEY[Y])),o=Math.min(o,P-(h?i.fEZlow[Y]:i.fEZ[Y])),n=Math.max(n,P+(h?i.fEZhigh[Y]:i.fEZ[Y]))):(s=Math.min(s,M),t=Math.max(t,M),l=Math.min(l,x),r=Math.max(r,x),o=Math.min(o,P),n=Math.max(n,P))}function _(Y,M,x){return Y<M?x*(M-Y):Math.abs(Y)<1e5?.02:.02*Math.abs(Y)}const X=_(s,t,i.fMargin),m=_(l,r,i.fMargin),N=_(o,n,0);let e=s-X,a=t+X,c=l-m,f=r+m,d=o-N,T=n+N;e<0&&s>=0&&(e=.98*s),a>0&&t<=0&&(a=0),c<0&&l>=0&&(c=.98*l),f>0&&r<=0&&(f=0),d<0&&o>=0&&(d=.98*o),T>0&&n<=0&&(T=0);const y=this.getObject();y.fMinimum!==Z.kNoZoom&&(d=y.fMinimum),y.fMaximum!==Z.kNoZoom&&(T=y.fMaximum),this._own_histogram=!0;const u=(0,Z.createHistogram)(Z.clTH2F,y.fNpx,y.fNpy);if(u.fName=y.fName+"_h",(0,Z.setHistogramTitle)(u,y.fTitle),u.fXaxis.fXmin=e,u.fXaxis.fXmax=a,u.fYaxis.fXmin=c,u.fYaxis.fXmax=f,u.fZaxis.fXmin=d,u.fZaxis.fXmax=T,u.fMinimum=d,u.fMaximum=T,u.fBits|=Z.kNoStats,!this.options.isAny()){const Y=this.buildDelaunay(y);if(Y)for(let M=0;M<y.fNpx;++M){const x=e+(M+.5)/y.fNpx*(a-e);for(let P=0;P<y.fNpy;++P){const E=Y.ComputeZ(x,c+(P+.5)/y.fNpy*(f-c));u.fArray[u.getBin(M+1,P+1)]=E}}}return u}buildDelaunay(i){return this._delaunay||(this._delaunay=new mt(i),this._delaunay.FindAllTriangles(),this._delaunay.fNdt||delete this._delaunay),this._delaunay}drawTriangles(i,h,s,t){const l=this.buildDelaunay(h);if(!l)return;const r=i.logz?m=>m<i.scale_zmin?-.1:i.grz(m):i.grz,o=2===this.options.Triangles,n=this.options.Triangles>=10||o,_=this.options.Triangles%10==1||o&&h.fLineColor!==h.fFillColor,X=new ut.N7(s,r,0,2*i.size_z3d,_);for(X.loop=0;X.loop<2;++X.loop){X.createBuffers();for(let m=0;m<l.fNdt;++m){const N=[l.fPTried[m],l.fNTried[m],l.fMTried[m]],e=[];let a=!0;for(let c=0;c<3;++c){const f=N[c]-1;e.push(i.grx(h.fX[f]),i.gry(h.fY[f]),r(h.fZ[f])),(h.fX[f]<i.scale_xmin||h.fX[f]>i.scale_xmax||h.fY[f]<i.scale_ymin||h.fY[f]>i.scale_ymax)&&(a=!1)}n&&a&&X.addMainTriangle(...e),_&&a&&(X.addLineSegment(e[0],e[1],e[2],e[3],e[4],e[5]),X.addLineSegment(e[3],e[4],e[5],e[6],e[7],e[8]),X.addLineSegment(e[6],e[7],e[8],e[0],e[1],e[2]))}}X.callFuncs((m,N)=>{const e=(0,V.cD)(this.getMainPainter(),N,null,100,100),a=o?this.getColor(h.fFillColor):t.calcColor(m,s.length),c=new C.ZH.MeshBasicMaterial((0,C.Bx)(a,{side:C.ZH.DoubleSide,vertexColors:!1})),f=new C.ZH.Mesh(e,c);i.add3DMesh(f,this),f.painter=this},(m,N)=>{const e=this.getColor(h.fLineColor),a=new C.ZH.LineBasicMaterial({color:new C.ZH.Color(e),linewidth:h.fLineWidth}),c=(0,C.Fc)((0,V.QK)(this.getMainPainter(),N,100,100),a);i.add3DMesh(c,this)})}updateObject(i,h){if(!this.matchObjectType(i))return!1;if(h&&h!==this.options.original&&this.decodeOptions(h,i),Object.assign(this.getObject(),i),delete this._delaunay,delete this.$redraw_hist,this.axes_draw){const s=this.getMainPainter();s?.updateObject(this.createHistogram(),this.options.Axis),this.$redraw_hist=s}return!0}redraw(){var i=this;return(0,R.A)(function*(){let h=Promise.resolve(!0);return i.$redraw_hist&&(h=i.$redraw_hist.redraw(),delete i.$redraw_hist),h.then(()=>i.drawGraph2D())})()}drawGraph2D(){var i=this;return(0,R.A)(function*(){const h=i.getMainPainter(),s=i.getFramePainter(),t=i.getObject();if(!(t&&h&&s&&s.mode3d))return i;if(s.remove3DMeshes(i),!i.options.isAny()){if(h.draw_content)return i;1===t.fMarkerSize&&1===t.fMarkerStyle?i.options.Circles=!0:i.options.Markers=!0}const l=(N,e)=>{let a=0;for(let c=0;c<t.fNpoints;++c)t.fX[c]<s.scale_xmin||t.fX[c]>s.scale_xmax||t.fY[c]<s.scale_ymin||t.fY[c]>s.scale_ymax||t.fZ[c]<N||t.fZ[c]>=e||++a;return a};let r=1;if(Z.settings.OptimizeDraw>0&&!s.webgl){const N=l(s.scale_zmin,s.scale_zmax),e=5e4;N>e&&(r=Math.floor(N/e),r<=2&&(r=2))}const o=i.createAttMarker({attr:t,std:!1}),n=[];let _=null,X=[s.scale_zmin,s.scale_zmax],m=s.size_x3d/100*o.getFullSize();i.options.Circles&&(m=.06*s.size_x3d),s.usesvg&&(m*=.3),m*=7*Math.max(s.size_x3d/s.getFrameWidth(),s.size_z3d/s.getFrameHeight()),(i.options.Color||i.options.Triangles>=10)&&(X=h.getContourLevels(!0),_=h.getHistPalette()),i.options.Triangles&&i.drawTriangles(s,t,X,_);for(let N=0;N<X.length-1;++N){const e=Math.max(X[N],s.scale_zmin),a=Math.min(X[N+1],s.scale_zmax);if(e>=a)continue;const c=Math.floor(l(e,a)/r),f=new Int32Array(c);let d=null,T=0,y=0,u=null,Y=!1,M=null,x=0,P=0;(i.options.Markers||i.options.Circles)&&(d=new C._l(c,s.webgl,m/3)),i.options.Error&&(u=new Float32Array(6*c*3),Y=i.matchObjectType(Z.clTGraph2DAsymmErrors)),i.options.Line&&(M=new Float32Array(6*(c-1)));for(let p=0;p<t.fNpoints;++p){if(t.fX[p]<s.scale_xmin||t.fX[p]>s.scale_xmax||t.fY[p]<s.scale_ymin||t.fY[p]>s.scale_ymax||t.fZ[p]<e||t.fZ[p]>=a||r>1&&(T=(T+1)%r,0!==T))continue;f[y++]=p;const E=s.grx(t.fX[p]),g=s.gry(t.fY[p]),w=s.grz(t.fZ[p]);d&&d.addPoint(E,g,w),u&&(u[x]=s.grx(t.fX[p]-(Y?t.fEXlow[p]:t.fEX[p])),u[x+1]=g,u[x+2]=w,u[x+3]=s.grx(t.fX[p]+(Y?t.fEXhigh[p]:t.fEX[p])),u[x+4]=g,u[x+5]=w,x+=6,u[x]=E,u[x+1]=s.gry(t.fY[p]-(Y?t.fEYlow[p]:t.fEY[p])),u[x+2]=w,u[x+3]=E,u[x+4]=s.gry(t.fY[p]+(Y?t.fEYhigh[p]:t.fEY[p])),u[x+5]=w,x+=6,u[x]=E,u[x+1]=g,u[x+2]=s.grz(t.fZ[p]-(Y?t.fEZlow[p]:t.fEZ[p])),u[x+3]=E,u[x+4]=g,u[x+5]=s.grz(t.fZ[p]+(Y?t.fEZhigh[p]:t.fEZ[p])),x+=6),M&&(P>=6&&(M[P]=M[P-3],M[P+1]=M[P-2],M[P+2]=M[P-1],P+=3),M[P]=E,M[P+1]=g,M[P+2]=w,P+=3)}if(M&&P>3&&M.length===P){const p=i.getColor(t.fLineColor),E=new C.ZH.LineBasicMaterial({color:new C.ZH.Color(p),linewidth:t.fLineWidth}),g=(0,C.Fc)(M,E);s.add3DMesh(g,i),g.graph=t,g.index=f,g.fp=s,g.scale0=.7*m,g.tip_name=i.getObjectHint(),g.tip_color=3===t.fMarkerColor?16711680:65280,g.nvertex=2,g.check_next=!0,g.tooltip=W}if(u){const p=i.getColor(t.fLineColor),E=new C.ZH.LineBasicMaterial({color:new C.ZH.Color(p),linewidth:t.fLineWidth}),g=(0,C.Fc)(u,E);s.add3DMesh(g,i),g.graph=t,g.index=f,g.fp=s,g.scale0=.7*m,g.tip_name=i.getObjectHint(),g.tip_color=3===t.fMarkerColor?16711680:65280,g.nvertex=6,g.tooltip=W}if(d){let p="blue";(!i.options.Circles||i.options.Color)&&(p=_?.calcColor(N,X.length)??i.getColor(t.fMarkerColor));const E=d.createPoints({color:p,style:i.options.Circles?4:t.fMarkerStyle}).then(g=>{g.graph=t,g.fp=s,g.tip_color=3===t.fMarkerColor?16711680:65280,g.scale0=.3*m,g.index=f,g.tip_name=i.getObjectHint(),g.tooltip=W,s.add3DMesh(g,i)});n.push(E)}}return Promise.all(n).then(()=>{const N=i.getMainPainter();if(!i.axes_draw&&!1!==N?.draw_content)return;const a=N?.findFunction(Z.clTPaletteAxis),c=i.getPadPainter()?.findPainterFor(a);if(c){if(c.Enabled=i.options.Zscale,i.options.Zscale)return c.drawPave();c.removeG()}}).then(()=>(s.render3D(100),i))})()}static draw(i,h,s){return(0,R.A)(function*(){const t=new $(i,h);t.decodeOptions(s,h);let l=Promise.resolve(null);return t.getMainPainter()||(l=dt.TH2Painter.draw(i,t.createHistogram(),t.options.Axis),t.axes_draw=!0),l.then(()=>(t.addToPadPrimitives(),t.drawGraph2D()))})()}}}}]);
//# sourceMappingURL=763.7bf80b6745caf98b.js.map