{"version":3,"file":"299.1dbc970e0e6b9e85.js","mappings":"sMAaA,MAAMA,UAA0BC,KAG7BC,cACqBC,IAAdC,KAAKC,MAAoBD,KAAKE,cACpC,CAGDC,cAAcC,GAEX,IAAIC,EAAI,IAAIC,KAAYF,GAAO,UAE1BJ,KAAKO,UAASP,KAAKO,QAAU,IAElCC,OAAOC,OAAOT,KAAKO,QAAS,CACxBG,KAAML,EAAEM,MAAM,QACdC,OAAQP,EAAEM,MAAM,UAChBE,MAAOR,EAAEM,MAAM,WAGnBX,KAAKc,aAAaV,EACpB,CAGDW,eAAeC,GAAM,MAEbA,IACFA,EAAO,EACPhB,KAAKiB,mBAAoB,GAG5B,IAAIC,EAAG,UAAGlB,KAAKmB,mBAAR,aAAGC,EAAkBC,OAAOC,IAAItB,KAAKC,MAE5C,OAAKiB,GAAQF,GAAQE,EAAII,IAAIC,eACnBvB,KAAKiB,kBACLO,QAAQC,YAAR,EAGHC,MAAK1B,KAAK2B,SAAUT,EAAII,IAAIN,GAAOE,EAAId,IAAIY,IAAOY,KAAKC,IAEvDA,IAAUA,EAASC,UAAY9B,KAAK+B,QACjC/B,KAAKe,eAAeC,EAAK,IAGrC,CAGDgB,kBACG,IAAKhC,KAAKO,QAAS,OAEnB,IAAI0B,EAAKjC,KAAKmB,YAEd,GAAInB,KAAKO,QAAQM,aAEPb,KAAKC,UAIf,GAAID,KAAKkC,qBAAsB,QACrBlC,KAAKkC,qBAGZ,IAAIC,EAAKnC,KAAKoC,gBACd,IAAKD,EAGF,mBADOnC,KAAKC,KAKfkC,EAAGE,gBAAgBC,GAAMA,EAAER,YAAc9B,KAAK+B,QAG9C/B,KAAKe,iBAAiBa,KAAK,IAAM5B,KAAKgC,kBACxC,SAAUhC,KAAKuC,gBACbC,aAAaxC,KAAKuC,wBACXvC,KAAKuC,gBAEZvC,KAAKkC,sBAAuB,EAE5BO,sBAAsB,IAAMzC,KAAKgC,uBAC7B,CAEJ,IAAIU,EAAYT,EAAGU,WAGnB,KAFKD,GAAcA,EAAU,OAAMA,EAAY,MAEzC1C,KAAKC,KAAOgC,EAAGZ,OAAOC,IAAIC,OAC7B,KAAIvB,KAAKO,QAAQK,OAKd,mBADOZ,KAAKC,KAHZD,KAAKC,KAAO,EACZyC,EAAYE,KAAKC,IAAI,IAAM,EAAEH,EAI/B,CAGJ1C,KAAKuC,gBAAkBO,WAAW,IAAM9C,KAAKgC,kBAAmBU,EAClE,CACH,CAGDxC,eACG,YAAKD,KAAO,EAELD,KAAKe,iBAAiBa,KAAK,KAC/B5B,KAAKgC,kBACEhC,MAEZ,CAGU+C,YAACC,EAAKf,EAAI7B,GAClB,IAAK6B,EAAGgB,OACNC,eAAQC,MAAM,8BACP,KAGT,IAAIC,EAAU,IAAIxD,EAAkBoD,EAAKf,GAEzC,OAAImB,EAAQC,kBACTH,QAAQC,MAAM,qDACP,OAGVC,EAAQjD,cAAcC,IAEjB6B,EAAGgB,OAAOK,QAAUrB,EAAGqB,SACzBrB,EAAGgB,OAAOK,OAASrB,EAAGqB,QAEzBF,EAAQrB,OAAS,SAAWwB,yBAErBC,SAAgBR,EAAKf,EAAGgB,OAAQ,QAAQrB,KAAK,KACjDwB,EAAQK,qBACDL,EAAQlD,iBAEpB,EAvI0C","names":["TGraphTimePainter","ObjectPainter","redraw","undefined","this","step","startDrawing","decodeOptions","opt","d","DrawOptions","options","Object","assign","once","check","repeat","first","storeDrawOpt","drawPrimitives","indx","_doing_primitives","lst","getObject","_this$getObject","fSteps","arr","length","Promise","resolve","draw","getDom","then","ppainter","$grtimeid","selfid","continueDrawing","gr","wait_animation_frame","pp","getPadPainter","cleanPrimitives","p","running_timeout","clearTimeout","requestAnimationFrame","sleeptime","fSleepTime","Math","max","setTimeout","static","dom","fFrame","console","error","painter","getMainPainter","fTitle","internals","TH1Painter","addToPadPrimitives"],"sourceRoot":"webpack:///","sources":["../node_modules/jsroot/modules/hist/TGraphTimePainter.mjs"],"sourcesContent":["import { internals } from '../core.mjs';\nimport { DrawOptions } from '../base/BasePainter.mjs';\nimport { ObjectPainter } from '../base/ObjectPainter.mjs';\nimport { TH1Painter } from '../hist2d/TH1Painter.mjs';\nimport { draw } from '../draw.mjs';\n\n\n/**\n * @summary Painter for TGraphTime object\n *\n * @private\n */\n\nclass TGraphTimePainter extends ObjectPainter {\n\n   /** @summary Redraw object */\n   redraw() {\n      if (this.step === undefined) this.startDrawing();\n   }\n\n   /** @summary Decode drawing options */\n   decodeOptions(opt) {\n\n      let d = new DrawOptions(opt || \"REPEAT\");\n\n      if (!this.options) this.options = {};\n\n      Object.assign(this.options, {\n          once: d.check(\"ONCE\"),\n          repeat: d.check(\"REPEAT\"),\n          first: d.check(\"FIRST\")\n      });\n\n      this.storeDrawOpt(opt);\n   }\n\n   /** @summary Draw primitives */\n   drawPrimitives(indx) {\n\n      if (!indx) {\n         indx = 0;\n         this._doing_primitives = true;\n      }\n\n      let lst = this.getObject()?.fSteps.arr[this.step];\n\n      if (!lst || (indx >= lst.arr.length)) {\n         delete this._doing_primitives;\n         return Promise.resolve();\n      }\n\n      return draw(this.getDom(), lst.arr[indx], lst.opt[indx]).then(ppainter => {\n\n         if (ppainter) ppainter.$grtimeid = this.selfid; // indicator that painter created by ourself\n         return this.drawPrimitives(indx+1);\n\n      });\n   }\n\n   /** @summary Continue drawing */\n   continueDrawing() {\n      if (!this.options) return;\n\n      let gr = this.getObject();\n\n      if (this.options.first) {\n         // draw only single frame, cancel all others\n         delete this.step;\n         return;\n      }\n\n      if (this.wait_animation_frame) {\n         delete this.wait_animation_frame;\n\n         // clear pad\n         let pp = this.getPadPainter();\n         if (!pp) {\n            // most probably, pad is cleared\n            delete this.step;\n            return;\n         }\n\n         // clear primitives produced by the TGraphTime\n         pp.cleanPrimitives(p => (p.$grtimeid === this.selfid));\n\n         // draw ptrimitives again\n         this.drawPrimitives().then(() => this.continueDrawing());\n      } else if (this.running_timeout) {\n         clearTimeout(this.running_timeout);\n         delete this.running_timeout;\n\n         this.wait_animation_frame = true;\n         // use animation frame to disable update in inactive form\n         requestAnimationFrame(() => this.continueDrawing());\n      } else {\n\n         let sleeptime = gr.fSleepTime;\n         if (!sleeptime || (sleeptime<100)) sleeptime = 10;\n\n         if (++this.step > gr.fSteps.arr.length) {\n            if (this.options.repeat) {\n               this.step = 0; // start again\n               sleeptime = Math.max(5000, 5*sleeptime); // increase sleep time\n            } else {\n               delete this.step;    // clear indicator that animation running\n               return;\n            }\n         }\n\n         this.running_timeout = setTimeout(() => this.continueDrawing(), sleeptime);\n      }\n   }\n\n   /** @ummary Start drawing of graph time */\n   startDrawing() {\n      this.step = 0;\n\n      return this.drawPrimitives().then(() => {\n         this.continueDrawing();\n         return this;\n      });\n   }\n\n   /** @summary Draw TGraphTime object */\n   static draw(dom, gr, opt) {\n      if (!gr.fFrame) {\n        console.error('Frame histogram not exists');\n        return null;\n      }\n\n      let painter = new TGraphTimePainter(dom, gr);\n\n      if (painter.getMainPainter()) {\n         console.error('Cannot draw graph time on top of other histograms');\n         return null;\n      }\n\n      painter.decodeOptions(opt);\n\n      if (!gr.fFrame.fTitle && gr.fTitle)\n         gr.fFrame.fTitle = gr.fTitle;\n\n      painter.selfid = \"grtime\" + internals.id_counter++; // use to identify primitives which should be clean\n\n      return TH1Painter.draw(dom, gr.fFrame, \"AXIS\").then(() => {\n         painter.addToPadPrimitives();\n         return painter.startDrawing();\n      });\n   }\n\n} // class TGraphTimePainter\n\nexport { TGraphTimePainter };\n"],"x_google_ignoreList":[0]}