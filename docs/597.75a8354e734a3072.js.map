{"version":3,"file":"597.75a8354e734a3072.js","mappings":"kJAMA,SAASA,EAAmBC,GACF,wCAAlBA,EAAKC,WAA2E,mCAAlBD,EAAKC,WAC3C,IAAtBD,EAAKE,eACNF,EAAKG,QAAS,EACdH,EAAKE,aAAe,EACpBF,EAAKI,aAAe,EACpBJ,EAAKK,KAAO,GAGfL,EAAKM,IAAMN,EAAKK,KAChBL,EAAKO,IAAMP,EAAKK,KAAOL,EAAKI,aAAaJ,EAAKE,aAC9CF,EAAKQ,WAAa,WAAa,OAAOC,KAAKL,YAAe,EAC1DJ,EAAKU,YAAc,SAASC,GAAO,OAAOF,KAAKJ,KAAOM,EAAIF,KAAKP,YAAe,EAC9EF,EAAKY,QAAU,SAASC,EAAEC,GAAO,OAAOC,KAAKC,OAAOH,EAAIJ,KAAKJ,MAAMI,KAAKP,aAAeY,EAAO,GACpE,sCAAlBd,EAAKC,YACbD,EAAKM,IAAMN,EAAKiB,YAAY,GAC5BjB,EAAKO,IAAMP,EAAKiB,YAAYjB,EAAKiB,YAAYC,OAAS,GACtDlB,EAAKQ,WAAa,WAAa,OAAOC,KAAKQ,YAAYC,MAAS,EAChElB,EAAKU,YAAc,SAASC,GACzB,IAAIQ,EAAOJ,KAAKK,MAAMT,GACtB,GAAIQ,GAAQ,EAAG,OAAOV,KAAKQ,YAAY,GACvC,GAAIE,GAAQV,KAAKQ,YAAYC,OAAQ,OAAOT,KAAKQ,YAAYR,KAAKQ,YAAYC,OAAS,GACvF,GAAIC,GAAMR,EAAK,OAAOF,KAAKQ,YAAYE,GACvC,IAAIE,EAASV,EAAMQ,EAAQA,EAAO,EAAIA,EAAO,EAC7C,OAAOV,KAAKQ,YAAYE,GAAQJ,KAAKO,IAAIX,EAAIU,GAASZ,KAAKQ,YAAYI,GAASN,KAAKO,IAAIX,EAAIQ,EAC/F,EACDnB,EAAKY,QAAU,SAASC,EAAEC,GACvB,QAASS,EAAI,EAAGA,EAAId,KAAKQ,YAAYC,SAAUK,EAC5C,GAAIV,EAAIJ,KAAKQ,YAAYM,GAAI,OAAOR,KAAKC,MAAMO,EAAE,EAAET,GACtD,OAAOL,KAAKQ,YAAYC,OAAS,CACnC,GAKJlB,EAAKwB,aAAe,SAASb,GAAO,OAAOF,KAAKC,YAAYC,EAAI,GAAO,EACvEX,EAAKyB,cAAgB,SAASd,GAAO,OAAOF,KAAKC,YAAYC,EAAI,EAAK,CACxE,CAID,SAASe,EAASC,GACf,OAAQA,GAAOA,EAAIC,UAAaD,EAAIC,UAAUC,IAAM,IACtD,CAQD,MAAMC,UAAqBC,IAKxBC,YAAYC,EAAKC,GACdC,MAAMF,EAAKC,GACXzB,KAAK2B,QAAU,OACf3B,KAAK4B,cAAe,EACpB5B,KAAK6B,OAAS,EACd7B,KAAK8B,OAAS,EACd9B,KAAK+B,cAAe,EACpB/B,KAAKgC,QAAS,EAGdhC,KAAKiC,UAAS,EAChB,CAGDC,gBACG,IAAIhB,EAAMlB,KAAKmC,YACf,SAAOjB,IAAOA,EAAIkB,MACpB,CAGDH,SAASI,GACN,IAAInB,EAAMlB,KAAKmC,YAAaV,EAAQR,EAASC,GAE7C,OAAIO,GAAWA,EAAMa,gBAAiBD,GAqC1BZ,GAASP,GAAOA,EAAIkB,QAG7BX,EAAQP,IAEHO,EAAMa,eAAiBD,KACC,GAAtBZ,EAAMW,MAAM3B,QACbnB,EAAmBmC,EAAMW,MAAM,IAC/B9C,EAAmBmC,EAAMW,MAAM,IAC/B9C,EAAmBmC,EAAMW,MAAM,IAE/BX,EAAMc,GAAKd,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMgB,GAAKhB,EAAMe,UAAU,GAAK,EAChCf,EAAMiB,MAAQjB,EAAMe,UAAU,GAE9Bf,EAAMkB,GAAKlB,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMmB,GAAKnB,EAAMe,UAAU,GAAK,EAChCf,EAAMoB,MAAQpB,EAAMe,UAAU,GAE9Bf,EAAMqB,GAAKrB,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMsB,GAAKtB,EAAMe,UAAU,GAAK,EAChCf,EAAMuB,MAAQvB,EAAMe,UAAU,GAG9Bf,EAAMwB,OAAS,SAAS7C,EAAG8C,EAAGC,GAAK,OAAQ/C,EAAE,EAAKJ,KAAKoC,MAAM,GAAGrC,cAAcmD,EAAE,GAAKlD,KAAKoC,MAAM,GAAGrC,aAAaC,KAAKoC,MAAM,GAAGrC,cAAcoD,EAAE,EAAK,EAIhJ1B,EAAM2B,QADJ3B,EAAMiB,MAAQ,GAAOjB,EAAMoB,MAAQ,GAAOpB,EAAMuB,MAAQ,EAC1C,SAAS5C,EAAG8C,EAAGC,GAAK,OAAO7C,KAAKC,OAAOH,EAAEJ,KAAKyC,IAAIzC,KAAK0C,OAAS1C,KAAKuC,GAAGvC,KAAK0C,MAAMpC,KAAKC,OAAO2C,EAAElD,KAAK4C,IAAI5C,KAAK6C,OAAS7C,KAAKuC,GAAGvC,KAAK0C,MAAM1C,KAAK2C,GAAG3C,KAAK6C,MAAMvC,KAAKC,OAAO4C,EAAEnD,KAAK+C,IAAI/C,KAAKgD,MAAS,EAEnM,SAAS5C,EAAG8C,EAAGC,GAAK,OAAQ/C,EAAEJ,KAAKyC,GAAMzC,KAAKuC,IAAIW,EAAElD,KAAK4C,IAAM5C,KAAKuC,GAAGvC,KAAK2C,IAAIQ,EAAEJ,GAAM,EAE3GtB,EAAMa,cAAgB,SAASlC,EAAG8C,EAAGC,GAAK,OAAOnD,KAAKqD,YAAYrD,KAAKoD,QAAQhD,EAAG8C,EAAGC,GAAM,EAC3F1B,EAAM6B,YAAc,SAASlD,EAAG8C,EAAGC,GAAK,OAAO7C,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAKsC,cAAclC,EAAG8C,EAAGC,IAAO,GAGpE,GAAtB1B,EAAMW,MAAM3B,QACpBnB,EAAmBmC,EAAMW,MAAM,IAC/B9C,EAAmBmC,EAAMW,MAAM,IAE/BX,EAAMc,GAAKd,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMgB,GAAKhB,EAAMe,UAAU,GAAK,EAChCf,EAAMiB,MAAQjB,EAAMe,UAAU,GAE9Bf,EAAMkB,GAAKlB,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMmB,GAAKnB,EAAMe,UAAU,GAAK,EAChCf,EAAMoB,MAAQpB,EAAMe,UAAU,GAG9Bf,EAAMwB,OAAS,SAAS7C,EAAG8C,GAAK,OAAQ9C,EAAE,EAAKJ,KAAKoC,MAAM,GAAGrC,cAAcmD,EAAE,EAAK,EAI/EzB,EAAM2B,QADJ3B,EAAMiB,MAAQ,GAAOjB,EAAMoB,MAAQ,EACrB,SAASzC,EAAG8C,GAAK,OAAO5C,KAAKC,OAAOH,EAAEJ,KAAKyC,IAAIzC,KAAK0C,OAAS1C,KAAKuC,GAAGvC,KAAK0C,MAAMpC,KAAKC,OAAO2C,EAAElD,KAAK4C,IAAI5C,KAAK6C,MAAS,EAErH,SAASzC,EAAG8C,GAAK,OAAQ9C,EAAEJ,KAAKyC,GAAMzC,KAAKuC,IAAIW,EAAElD,KAAK4C,GAAM,EAE/EnB,EAAMa,cAAgB,SAASlC,EAAG8C,GAAK,OAAOlD,KAAKqD,YAAYrD,KAAKoD,QAAQhD,EAAG8C,GAAM,EACrFzB,EAAM6B,YAAc,SAASlD,EAAG8C,GAAK,OAAO5C,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAKsC,cAAclC,EAAG8C,IAAO,IAE5F5D,EAAmBmC,EAAMW,MAAM,IAC/BX,EAAMc,GAAKd,EAAMe,UAAU,GAAKf,EAAMe,UAAU,GAChDf,EAAMgB,GAAKhB,EAAMe,UAAU,GAAK,EAChCf,EAAMiB,MAAQjB,EAAMe,UAAU,GAE9Bf,EAAMwB,OAAS,SAAS7C,GAAK,OAAOA,EAAE,CAAI,EAEvCqB,EAAM2B,QADL3B,EAAMiB,MAAQ,EACC,SAAStC,GAAK,OAAOE,KAAKC,OAAOH,EAAEJ,KAAKyC,IAAIzC,KAAK0C,MAAS,EAE1D,SAAStC,GAAK,OAAOA,EAAEJ,KAAKyC,EAAK,EACpDhB,EAAMa,cAAgB,SAASlC,GAAK,OAAOJ,KAAKqD,YAAYrD,KAAKoD,QAAQhD,GAAM,EAC/EqB,EAAM6B,YAAc,SAASlD,GAAK,OAAOE,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAKsC,cAAclC,IAAO,KA3GxFqB,EAAMW,MAAMoB,IACblE,EAAmBmC,EAAMW,MAAMqB,IAC/BnE,EAAmBmC,EAAMW,MAAMsB,IAC/BpE,EAAmBmC,EAAMW,MAAMoB,IAC/B/B,EAAMwB,OAAS,SAAS7C,EAAG8C,EAAGC,GAAK,OAAQ/C,EAAE,EAAKJ,KAAKoC,MAAMqB,GAAG1D,cAAcmD,EAAE,GAAKlD,KAAKoC,MAAMqB,GAAG1D,aAAaC,KAAKoC,MAAMsB,GAAG3D,cAAcoD,EAAE,EAAK,EAEnJ1B,EAAMa,cAAgB,SAASlC,EAAG8C,EAAGC,GAAK,OAAOnD,KAAK2D,YAAYN,YAAYrD,KAAKiD,OAAO7C,EAAG8C,EAAGC,GAAM,EACtG1B,EAAM6B,YAAc,SAASlD,EAAG8C,EAAGC,GAChC,IAAIjD,EAAMF,KAAKiD,OAAO7C,EAAG8C,EAAGC,GAC5B,OAAInD,KAAK2D,YAAYC,mBACXtD,KAAKiD,KAAKvD,KAAK2D,YAAYC,mBAAmB1D,IACjDI,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAK2D,YAAYN,YAAYnD,IACzD,GACOuB,EAAMW,MAAMsB,IACpBpE,EAAmBmC,EAAMW,MAAMqB,IAC/BnE,EAAmBmC,EAAMW,MAAMsB,IAC/BjC,EAAMwB,OAAS,SAAS7C,EAAG8C,GAAK,OAAQ9C,EAAE,EAAKJ,KAAKoC,MAAMqB,GAAG1D,cAAcmD,EAAE,EAAK,EAElFzB,EAAMa,cAAgB,SAASlC,EAAG8C,GAAK,OAAOlD,KAAK2D,YAAYN,YAAYrD,KAAKiD,OAAO7C,EAAG8C,GAAM,EAChGzB,EAAM6B,YAAc,SAASlD,EAAG8C,GAC7B,IAAIhD,EAAMF,KAAKiD,OAAO7C,EAAG8C,GACzB,OAAIlD,KAAK2D,YAAYC,mBACXtD,KAAKiD,KAAKvD,KAAK2D,YAAYC,mBAAmB1D,IACjDI,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAK2D,YAAYN,YAAYnD,IACzD,IAEDZ,EAAmBmC,EAAMW,MAAMqB,IAC/BhC,EAAMwB,OAAS,SAAS7C,GAAK,OAAOA,EAAE,CAAI,EAE1CqB,EAAMa,cAAgB,SAASlC,GAAK,OAAOJ,KAAK2D,YAAYN,YAAYjD,EAAE,EAAK,EAC/EqB,EAAM6B,YAAc,SAASlD,GAC1B,OAAIJ,KAAK2D,YAAYC,mBACXtD,KAAKiD,KAAKvD,KAAK2D,YAAYC,mBAAmBxD,EAAE,IACnDE,KAAKiD,KAAKjD,KAAKO,IAAIb,KAAK2D,YAAYN,YAAYjD,EAAE,IAC3D,GA6EAqB,CACT,CAGDoC,gBACQ7D,KAAK8D,UAAS9D,KAAK8D,QAAU,CAAEC,KAAO,GAC7C,CAGDC,gBAAgBC,GACTA,IAAQjE,OACJA,KAAK8D,QACXI,OADyBD,EAAIH,QACjBI,OAChB,CAGDC,sBACGnE,KAAKoE,eAAeC,IACZA,IAAYrE,MAA4C,mBAA3BqE,EAAQL,iBACvCK,EAAQL,gBAAgBhE,KAAxB,EACH,UACL,CAGDsE,eACG,IAAIC,EAAKvE,KAAKwE,kBACmB,mBAA7B,MAAOD,OAAP,EAAOA,EAAIE,gBACZF,EAAGE,eAAc,GACpBzE,KAAKgC,QAAS,CAChB,CAGD0C,UACG1E,KAAKsE,sBAEEtE,KAAK8D,QAEZpC,MAAMgD,SACR,CAGDC,eAAiB,OAAO,CAAI,CAI5BC,cAKC,CAGDC,gBAEG,IAAIC,EAAO9E,KAAKwE,kBAChB,OAAKM,EAGA9E,KAAK4B,aAGL5B,KAAK+E,iBAQVD,EAAKE,cACLF,EAAKG,KAAOH,EAAKI,KAAO,EACxBJ,EAAKK,KAAOL,EAAKM,KAAO,EACxBN,EAAKO,KAAOP,EAAKQ,KAAO,EACxBR,EAAKS,cAAcvF,KAAKwF,QAAQ,KAAMxF,KAAKiF,KAAMjF,KAAKkF,KAAMlF,KAAKwF,QAAQ,KAAMxF,KAAKmF,KAAMnF,KAAKoF,KAAMpF,KAAKwF,QAAQ,KAAMxF,KAAKqF,KAAMrF,KAAKsF,MACjIR,EAAKW,YAZJzF,KAAK8D,QAAQ4B,UAAa1F,KAAK8D,QAAQ6B,UAG5Cb,EAAKc,eAAe5F,KAAK8D,QAAQ4B,SAAU1F,KAAKwF,QAAQ,KAAMxF,KAAKiF,KAAMjF,KAAKkF,KAAMlF,KAAK8D,QAAQ6B,SAAU3F,KAAKwF,QAAQ,KAAMxF,KAAKmF,KAAMnF,KAAKoF,MACvIN,EAAKe,UAAU7F,KAAK8D,QAAQ4B,SAAU1F,KAAK8D,QAAQ6B,WAHhDG,QAAQC,SAAQ,GAJnBD,QAAQC,SAAQ,GAHhBD,QAAQC,SAAQ,EAmB5B,CAGDC,2BACGhG,KAAKiG,kBACLjG,KAAKkG,iBACP,CAGDC,kBAAkBjF,EAAK+C,GACpB,SAAK/C,IAAQ+C,IAEb/C,EAAIkB,MAAQ6B,EAAI7B,MAChBlB,EAAIsB,UAAYyB,EAAIzB,UACpBtB,EAAImC,YAAcY,EAAIZ,YACtBnC,EAAIkF,SAAWnC,EAAImC,SACnBlF,EAAImF,YAAcpC,EAAIoC,YACtBnF,EAAIoF,SAAWrC,EAAIqC,SAGnBtG,KAAKiC,UAAS,GAEP,GACT,CAGDsE,aAAarF,GAEV,IAAIsF,EAASxG,KAAKmC,YAElB,GAAIjB,IAAQsF,EAAQ,CAEjB,IAAKxG,KAAKyG,gBAAgBvF,GAAM,OAAO,EAEvC,GAAIlB,KAAKkC,gBAENlC,KAAKmG,kBAAkBK,EAAQtF,OAE3B,CAEJ,IAAIwF,EAAUzF,EAASuF,GACnBG,EAAO1F,EAASC,GAEpB,IAAKwF,IAAYC,EAAM,OAAO,EAG9BD,EAAQ/C,YAAcgD,EAAKhD,YAE3B6C,EAAOI,OAAS1F,EAAI0F,MACtB,CACH,CAED,YAAKhC,cAEL5E,KAAK6G,mBAAoB,GAElB,CACT,CAGDrB,QAAQsB,GACL,IAAIrF,EAAQzB,KAAKiC,WAAYf,EAAMlB,KAAKmC,YAAa5C,EAAO,KAE5D,GAAI2B,GAAOA,EAAIkB,MACZ,OAAO0E,OACC,IAE0B,QACtBvH,EAAO2B,EAAIkB,MAAM,GAAI,MAHC,IAC1B,IAAK7C,EAAO2B,EAAIkB,MAAM,GAAI,UAC1B,IAAK7C,EAAO2B,EAAIkB,MAAM,QACG,GAEzBX,GAASA,EAAMW,MAEvB,OAAO0E,OACC,IAE4B,QACxBvH,EAAOkC,EAAMW,MAAMqB,GAAI,MAHC,IAC5B,IAAKlE,EAAOkC,EAAMW,MAAMsB,GAAI,UAC5B,IAAKnE,EAAOkC,EAAMW,MAAMoB,GAKnC,OAAIjE,IAASA,EAAKU,aACfX,EAAmBC,GAEfA,CACT,CAGDwH,cAAcD,EAAM5G,EAAK8G,GACtB,IAAIC,EAAQjH,KAAKwE,kBACb0C,EAASD,EAAMH,EAAK,WACpBvH,EAAOS,KAAKwF,QAAQsB,GACpBK,EAAK5H,EAAKU,YAAYC,GAE1B,GAAoB,WAAhBgH,EAAOE,KACR,OAAOH,EAAMI,WAAWP,EAAMK,GAEjC,IAAIG,EAAK/H,EAAKU,YAAYC,GAAK8G,GAAQ,IAEvC,MAAoB,SAAhBE,EAAOE,KACDH,EAAMI,WAAWP,GAAOK,EAAGG,GAAI,GAElC,IAAML,EAAMI,WAAWP,EAAMK,GAAM,KAAOF,EAAMI,WAAWP,EAAMQ,GAAM,GAChF,CAIDC,sBAAsBC,GAGnB,IADYxH,KAAKiC,WACL,OAEZjC,KAAK6B,OAAS7B,KAAK8B,OAAS9B,KAAKyH,OAAS,EAE1C,IAAIlI,EAAOS,KAAKwF,QAAQ,KACxBxF,KAAK6B,OAAStC,EAAKQ,aACnBC,KAAKiF,KAAO1F,EAAKM,IACjBG,KAAKkF,KAAO3F,EAAKO,MAEb0H,EAAO,KACXjI,EAAOS,KAAKwF,QAAQ,KACpBxF,KAAK8B,OAASvC,EAAKQ,aACnBC,KAAKmF,KAAO5F,EAAKM,IACjBG,KAAKoF,KAAO7F,EAAKO,MAEb0H,EAAO,KACXjI,EAAOS,KAAKwF,QAAQ,KACpBxF,KAAKyH,OAASlI,EAAKQ,aACnBC,KAAKqF,KAAO9F,EAAKM,IACjBG,KAAKsF,KAAO/F,EAAKO,KACnB,CAGD4H,mBAGG,IAAIC,EAAU3H,KAAK+E,gBACf6C,EAAc5H,KAAK8D,QAAQ4B,UAAY1F,KAAK8D,QAAQ6B,SACpDpB,EAAKoD,GAAUC,EAAc5H,KAAKwE,kBAAoB,KAC1D,OAAOD,GAAKA,EAAGmD,kBAAkBC,GAAUC,EAC7C,CAGDC,iBAAiBC,EAAOC,GACrB,IAAK/H,KAAKkC,gBACP,OAAO8F,QAAQC,MAAM,0CAEpBF,EAAIG,QAAUlI,KAAKmI,qBAEN,OAAVL,GACD9H,KAAKmG,kBAAkBnG,KAAKmC,YAAa2F,EAAMM,MAGlDL,EAAIM,aAAY,GAErB,CAIDC,YAAYC,GAET,IAAIC,GAAiB,EAOrB,OANID,GAA4B,iBAAVA,GAAkD,GAA1BA,EAAOE,QAAQ,UACtDF,EAAOE,QAAQ,KAAO,IAAGD,GAAiB,GACzCxI,KAAK2E,eAAiB,GAAO4D,EAAOE,QAAQ,KAAO,IAAID,GAAiB,GACxExI,KAAK2E,eAAiB,GAAO4D,EAAOE,QAAQ,KAAO,IAAID,GAAiB,IAG5ExI,KAAKkC,iBAAmBsG,GAAkBxI,KAAK0I,gBAEnC1I,KAAK2I,YAAY,CAAEC,cAAc,IAGnCC,WACD,IAAI/C,QAAQuC,IAEhB,IAAIN,EAAM/H,KAAK8I,gBAAgB,GAAI,CAAEtJ,UAAW,mDACbQ,KAAK6H,iBAAiBkB,KAAK/I,OAC1D+H,GACD/H,KAAKmI,mBAAqBJ,EAAIG,MAC9BH,EAAIM,YAAcA,EAClBW,WAAWhJ,KAAK6H,iBAAiBkB,KAAK/I,KAAM,KAAM+H,GAAM,MAExDM,GAAY,EAAD,GAKhBvC,QAAQC,SAAQ,EACzB,CAIDkD,aACC,CAGDC,eAAe3J,EAAM4J,EAAM9I,GAExB,IAAIK,EAAO,EACP0I,EAAQpJ,KAAKwF,QAAQjG,GACrB8J,EAAQrJ,KAAK,QAAQT,IAAS,EAE9BS,KAAK8D,QAAQ4B,UAAoB,KAARnG,IAAaA,EAAO,MAC7CS,KAAK8D,QAAQ6B,UAAoB,KAARpG,IAAaA,EAAO,MAEjD,IAAIuF,EAAO9E,KAAKwE,kBACZ3E,EAAMiF,EAAOA,EAAK,QAAUvF,EAAO,OAAS,EAC5CO,EAAMgF,EAAOA,EAAK,QAAUvF,EAAO,OAAS,EAEhD,OAAKM,IAAQC,GAAQsJ,GAEf1I,EADS,QAARyI,EACMC,EAAMjJ,QAAQN,EAAKQ,GAAO,GAE1B+I,EAAMjJ,QAAQL,GAAMO,GAAO,GAAK,IACtCK,EAAK,EAAGA,EAAO,EAAYA,EAAK2I,IAAO3I,EAAO2I,IAElD3I,EAAgB,QAARyI,EAAkB,EAAIE,EAG1B3I,CACT,CAID4I,WAAa,CAGbC,YAAYC,GAET,OAAOA,OACC,aACF,GAAKxJ,KAAKyJ,YAAczJ,KAAK0J,WAAe1J,KAAK2J,YAAc3J,KAAK4J,WAAe5J,KAAK6J,YAAc7J,KAAK8J,UACxG,YAAKC,SACL/J,KAAKwE,kBAAkBwF,uBAAuB,UACvC,EAEV,GAAIhK,KAAK4B,aACN,YAAK0H,YACE,EAEV,UACE,aAActJ,KAAKwE,kBAAkByF,cAAc,KAAM,UACzD,aAAcjK,KAAKwE,kBAAkByF,cAAc,KAAM,UACzD,aAAcjK,KAAKwE,kBAAkByF,cAAc,KAAM,UACzD,gBAAiB,YAAKhB,cAAqB,EAEnD,OAAO,CACT,CAGDiB,YAAYC,GACT,IAAIC,EAAKpK,KAAKqK,iBACTD,IAELA,EAAGE,aAAa,YAAa,wCAAyC,aAAc,UACpFF,EAAGE,aAAa,cAAe,eAAgB,aAAc,YAC7DF,EAAGE,aAAa,WAAY,eAAgB,aAAc,UACtDtK,KAAK2E,eAAiB,GACvByF,EAAGE,aAAa,aAAc,eAAgB,cAC7CtK,KAAK4B,cACNwI,EAAGE,aAAa,UAAW,kBAAmB,iBAC5CH,GAAWC,EAAGG,iBACrB,CAGDC,aAAa9J,GACV,IAAIe,EAAQzB,KAAKiC,WACbwI,EAAM,CAAEvK,IAAKQ,EAAMoG,KAAMrF,EAAMiJ,OAAS,QAASC,MAAOlJ,EAAMmF,QAClE,OAAQ5G,KAAK2E,gBAAL,KACA,EACF8F,EAAIG,GAAKlK,EAAO,EAAG+J,EAAII,GAAK,EAC5BJ,EAAIK,MAAQrJ,EAAMa,cAAcmI,EAAIG,IACpCH,EAAIxC,MAAQxG,EAAM6B,YAAYmH,EAAIG,IAClCH,EAAIM,MAAQ/K,KAAKgL,eAAetK,EAAK,GACrC,WACE,EACF+J,EAAIG,GAAMlK,EAAOV,KAAK6B,OAAU,EAChC4I,EAAII,IAAMnK,GAAQ+J,EAAIG,GAAK,IAAM5K,KAAK6B,OAAS,EAC/C4I,EAAIK,MAAQrJ,EAAMa,cAAcmI,EAAIG,GAAIH,EAAII,IAC5CJ,EAAIxC,MAAQxG,EAAM6B,YAAYmH,EAAIG,GAAIH,EAAII,IAC1CJ,EAAIM,MAAQ/K,KAAKgL,eAAeP,EAAIG,GAAG,EAAGH,EAAII,GAAG,GACjD,WACE,EACFJ,EAAIG,GAAKlK,EAAOV,KAAK6B,OAAS,EAC9B4I,EAAII,IAAOnK,GAAQ+J,EAAIG,GAAK,IAAM5K,KAAK6B,OAAU7B,KAAK8B,OAAS,EAC/D2I,EAAIQ,IAAMvK,GAAQ+J,EAAIG,GAAK,IAAMH,EAAII,GAAK,GAAK7K,KAAK6B,QAAU7B,KAAK6B,OAAS7B,KAAK8B,OAAS,EAC1F2I,EAAIK,MAAQrJ,EAAMa,cAAcmI,EAAIG,GAAIH,EAAII,GAAIJ,EAAIQ,IACpDR,EAAIxC,MAAQxG,EAAM6B,YAAYmH,EAAIG,GAAIH,EAAII,GAAIJ,EAAIQ,IAClDR,EAAIM,MAAQ/K,KAAKgL,eAAeP,EAAIG,GAAG,EAAGH,EAAII,GAAG,EAAGJ,EAAIQ,GAAG,GAIjE,OAAOR,CACT,CAGDS,cAAcpG,EAAMqG,EAASC,GAC1B,IAAKtG,IAASqG,EAAS,OAElBC,IAAMA,EAAO,IAElB,IAAIC,EAAUC,yBACVjG,EAAOrF,KAAKuL,OAAQjG,EAAOtF,KAAKwL,OAAQC,EAAUzL,KAAK0L,UAEvDN,EAAKO,eACFN,EAAU,KAAIA,EAAU,IAC5BhG,EAAOrF,KAAK0L,WAGXrG,IAASC,IAAQD,EAAOrF,KAAK4L,QAAStG,EAAOtF,KAAK6L,QAASJ,EAAUzL,KAAK8L,YAE1E9L,KAAK2E,eAAiB,IACnBG,EAAK+E,YAAc/E,EAAKgF,WACzBzE,EAAOP,EAAK+E,UACZvE,EAAOR,EAAKgF,WACJsB,EAAKW,eACb1G,EAAOP,EAAKO,KACZC,EAAOR,EAAKQ,OAIlB6F,EAAQa,aAAalH,EAAKO,KAAMP,EAAKQ,MACrC6F,EAAQD,cAAcpG,EAAKmH,KAAMZ,EAAShG,EAAMC,EAAMmG,GAElDzL,KAAK2E,eAAiB,IACvBG,EAAKoH,WAAaf,EAAQgB,QAC1BrH,EAAKsH,WAAajB,EAAQkB,QAE/B,CAGDC,kBAAkBC,EAAMC,GACrB,IAAIvF,EAAQjH,KAAKwE,kBACjB,IAAKyC,EAAO,OACZ,IAAIwF,EAASxF,EAAMyF,aAAaF,GAAO,QAAUA,EAAMA,EAEvDD,EAAKI,MAAM,+BAAiCH,EAAM,0CADvC,IAAMvF,EAAMwF,EAAO,OAAS,IAAMxF,EAAMwF,EAAO,OAAS,KACgCG,KAAKC,KACrGA,EAAMA,EAAMC,KAAKC,MAAMF,GAAO,KACH,iBAAPA,GAAmC,GAAdA,EAAIpM,QAAiBuM,OAAOC,SAASJ,EAAI,KAAQG,OAAOC,SAASJ,EAAI,IAG3G5F,EAAMiG,KAAKV,EAAKK,EAAI,GAAIA,EAAI,IAF5B5F,EAAM8C,OAAOyC,EAEb,EAER,CAGDW,gBAAgBZ,GAEbA,EAAKlM,IAAI,2BAELL,KAAK4B,eACN2K,EAAKa,OAAOpN,KAAKiJ,WAAW,cAAe,eAAgB,IAAMjJ,KAAKiJ,cAE3C,GAAvBjJ,KAAK2E,gBACL4H,EAAKlM,IAAI,eAAgB,IAAML,KAAKsM,kBAAkBC,EAAM,MAEzB,mBAA5BvM,KAAKqN,qBACbrN,KAAKqN,oBAAoBd,IAG/B,IAAIhI,EAAKvE,KAAKwE,kBAEd,GAAIxE,KAAK8D,QAAQI,OAAQ,OAGlBqI,EAAKpD,OAAS,GACfoD,EAAKlM,IAAI,aAEZ,IAAIyE,EAAO9E,KAAKsN,kBAAoBtN,KAEpCuM,EAAKa,OAAOtI,EAAKyI,mBAAoB,gBAAiB,IAAMzI,EAAK0I,kBAAkB,WAEnFjB,EAAKa,OAAO7I,EAAGkJ,iBAAkB,iBAAkB,KAChDlJ,EAAGkJ,kBAAoBlJ,EAAGkJ,kBACrBlJ,EAAGkJ,kBAAoB3I,EAAK4I,gBAAkB5I,EAAK9C,QAAQ8C,EAAK4I,eAAe,KAApB,GAGxC,mBAAvB,MAAOnJ,OAAP,EAAOA,EAAIoJ,YACZpB,EAAKa,OAAOtI,EAAKhB,QAAQ8J,SAAU,YAAa,KAC7C9I,EAAKhB,QAAQ8J,UAAY9I,EAAKhB,QAAQ8J,SACtCrJ,EAAGoJ,UAAH,GAEHpB,EAAKa,OAAOtI,EAAKhB,QAAQ+J,QAAS,WAAY,KAC3C/I,EAAKhB,QAAQ+J,SAAW/I,EAAKhB,QAAQ+J,QACrCtJ,EAAGoJ,UAAH,IAIF3N,KAAK4B,eACN2K,EAAKa,QAAQpN,KAAK8D,QAAQgK,KAAM,iBAAkB,KAC/C9N,KAAK8D,QAAQgK,MAAQ9N,KAAK8D,QAAQgK,KAClC9N,KAAK+N,WAAL,IAGuB,IAArB/N,KAAK8D,QAAQkK,MAAqC,IAArBhO,KAAK8D,QAAQkK,OACxChO,KAAKiO,iBACNjO,KAAKiO,gBAAgB1B,IAIK,mBAA/B,UAAOzH,EAAKoJ,eAAZ,aAAOC,EAAcC,QACtB7B,EAAKlM,IAAI,eAAgB,IAAMyE,EAAKoJ,QAAQE,QACjD,CAED7B,SAAK8B,kBAAkBrO,MAEnBA,KAAK6G,mBAAqBtC,EAAGyF,0BAC9BuC,EAAKlM,IAAI,kBAAmB,IAAMkE,EAAGyF,uBAAuB,WAExD,CACT,CAGDsE,oBAAoB,MACbtO,KAAK+E,kBACN,eAAKsF,gBAAgBkE,oBAAeC,OAAWA,EAAW,+CAA1D,SAAmGC,cACxG,CAGDR,gBAAgB1B,GACbA,EAAKmC,eAAe1O,KAAK8D,QAAQ6K,SAAWC,mBAAkBpC,IAE3DxM,KAAK8D,QAAQ6K,QAAUE,SAASrC,GAChCxM,KAAK8O,QAAL,EAEL,CAGDC,eACG/O,KAAK8D,QAAQI,QAAUlE,KAAK8D,QAAQI,OAEhClE,KAAK8D,QAAQI,SACTlE,KAAK8D,QAAQkL,OAAShP,KAAK8D,QAAQkK,OAAShO,KAAK8D,QAAQmL,QAExDjP,KAAK8D,QAAQkK,KADXhO,KAAK6B,QAAQ,IAAQ7B,KAAK8B,QAAQ,GAChB9B,KAAK8D,QAAQoL,MAAQ,GAAK,GAE1BlP,KAAK8D,QAAQoL,MAAQ,GAAK,EAEjDlP,KAAK8D,QAAQgK,MAAO,GAI1B9N,KAAKmE,sBACLnE,KAAKmP,kBAAkB,MAAO,UAChC,CAGDxG,YAAYyC,GAEJA,IAAMA,EAAO,CAAEgE,UAAU,EAAMC,MAAO,EAAGC,OAAQ,SAEnCd,IAAfpD,EAAKiE,QAAqBjE,EAAKiE,MAAQ,QAClBb,IAArBpD,EAAKmE,cAA2BnE,EAAKmE,YAAcnE,EAAKiE,YACxCb,IAAhBpD,EAAKkE,SAAsBlE,EAAKkE,OAAS,GAE7C,IAGIE,EAAGC,EAAGrP,EAAG8C,EAAGwM,EAAMC,EAHlBlO,EAAQzB,KAAKiC,WAAY2N,EAAQ5P,KAAKwF,QAAQ,KAAMqK,EAAQ7P,KAAKwF,QAAQ,KACzEyB,EAAQjH,KAAKwE,kBACbsL,EAAO9P,KAAK2E,eAEZkI,EAAM,CACHkD,GAAI/P,KAAKkJ,eAAe,IAAK,OAAQ,EAAIkC,EAAKiE,OAC9CW,GAAIhQ,KAAKkJ,eAAe,IAAK,QAAS,EAAIkC,EAAKmE,aAC/CU,GAAKH,EAAO,EAAK,EAAI9P,KAAKkJ,eAAe,IAAK,OAAQ,EAAIkC,EAAKiE,OAC/Da,GAAKJ,EAAO,EAAK,EAAI9P,KAAKkJ,eAAe,IAAK,QAAS,EAAIkC,EAAKmE,aAChEY,GAAKL,EAAO,EAAK,EAAI9P,KAAKkJ,eAAe,IAAK,OAAQ,EAAIkC,EAAKiE,OAC/De,GAAKN,EAAO,EAAK,EAAI9P,KAAKkJ,eAAe,IAAK,QAAS,EAAIkC,EAAKmE,aAChEc,MAAO,EAAGC,MAAO,EAAGC,MAAO,EAC3B1Q,IAAK,EAAGC,IAAK,EAAG0Q,KAAM,EAAGC,MAAO,EAAGC,MAAO,EAAGC,MAAO,EAAGC,MAAO,GAsBrE,GAnBI5Q,KAAKkC,iBAAmBT,EAAMe,YAC3BqK,EAAIkD,GAAKtO,EAAMe,UAAU,KAAMqK,EAAIkD,GAAKtO,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GAC7EgE,EAAImD,GAAKvO,EAAMe,UAAU,KAAMqK,EAAImD,GAAKvO,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GACjFgE,EAAIwD,MAAQ5O,EAAMe,UAAU,GACxBqK,EAAIwD,MAAQ,IAAGxD,EAAIhE,YAAa,GAC/BiH,EAAO,GAAOrO,EAAMe,UAAU/B,OAAS,IACrCoM,EAAIoD,GAAKxO,EAAMe,UAAU,KAAMqK,EAAIoD,GAAKxO,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GAC7EgE,EAAIqD,GAAKzO,EAAMe,UAAU,KAAMqK,EAAIqD,GAAKzO,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GACjFgE,EAAIyD,MAAQ7O,EAAMe,UAAU,GACxBqK,EAAIyD,MAAQ,IAAGzD,EAAIhE,YAAa,IAElCiH,EAAO,GAAOrO,EAAMe,UAAU/B,OAAS,IACrCoM,EAAIsD,GAAK1O,EAAMe,UAAU,KAAMqK,EAAIsD,GAAK1O,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GAC7EgE,EAAIuD,GAAK3O,EAAMe,UAAU,KAAMqK,EAAIuD,GAAK3O,EAAMe,UAAU,GAAIqK,EAAIhE,YAAa,GACjFgE,EAAI0D,MAAQ9O,EAAMe,UAAU,GACxBqK,EAAI0D,MAAQ,IAAG1D,EAAIhE,YAAa,KAItCuC,EAAKxC,aAAc,OAAOiE,EAK9BA,EAAIgE,IAAM,IAAIC,MAAMjE,EAAImD,GAAGnD,EAAIwD,MAAM,GACrCxD,EAAIkE,IAAM,IAAID,MAAMjE,EAAIqD,GAAGrD,EAAIyD,MAAM,GAEjClF,EAAK4F,WACNnE,EAAImE,UAAW,EACfnE,EAAIoE,MAAQ,IAAIH,MAAMjE,EAAImD,GAAG,GAC7BnD,EAAIqE,MAAQ,IAAIJ,MAAMjE,EAAIqD,GAAG,IAG5B9E,EAAK+F,gBAAe/F,EAAKgE,UAAW,GAExC,IAAIgC,EAAQnK,EAAMoK,WAAWrR,KAAK8D,QAAQ4B,SAAU1F,KAAK8D,QAAQ6B,UAGjE,IAAK6J,EAAI3C,EAAIkD,GAAIP,GAAK3C,EAAImD,KAAMR,EAC7BpP,EAAIwP,EAAM3P,YAAYuP,EAAIpE,EAAKkE,QAC3B8B,EAAME,MAASlR,GAAK,EAAMyM,EAAIkD,GAAKP,EAAE,GACrC3C,EAAIoE,QAAOpE,EAAIoE,MAAMzB,GAAKpP,GAC9ByM,EAAIgE,IAAIrB,GAAK4B,EAAMP,IAAIzQ,GACnBgL,EAAKgE,WAAUvC,EAAIgE,IAAIrB,GAAKlP,KAAKK,MAAMkM,EAAIgE,IAAIrB,KAE/CpE,EAAKmG,QACF1E,EAAIgE,IAAIrB,IAAMvI,EAAMuK,WAAY3E,EAAIkD,GAAKP,EAAG3C,EAAIgE,IAAIrB,IAAMvI,EAAMuK,UAChE3E,EAAIgE,IAAIrB,GAAKvI,EAAMuK,WAAY3E,EAAImD,GAAKR,EAAG3C,EAAIgE,IAAIrB,GAAKvI,EAAMuK,YAUxE,IANIpG,EAAKmG,QACD1E,EAAIkD,GAAKlD,EAAImD,GAAG,GAAOnD,EAAIgE,IAAIhE,EAAIkD,KAAOlD,EAAIgE,IAAIhE,EAAIkD,GAAG,IAAKlD,EAAIkD,KAClElD,EAAIkD,GAAKlD,EAAImD,GAAG,GAAOnD,EAAIgE,IAAIhE,EAAImD,GAAG,IAAMnD,EAAIgE,IAAIhE,EAAImD,KAAMnD,EAAImD,MAInER,EAAI3C,EAAImD,GAAKnD,EAAIwD,MAAQ,GAC7BxD,EAAIgE,IAAIrB,KAAO3C,EAAIgE,IAAIhE,EAAImD,IAE9B,GAAa,IAATF,EACDjD,EAAIkE,IAAI,GAAKK,EAAML,IAAI,GACvBlE,EAAIkE,IAAI,GAAKK,EAAML,IAAI,QAE1B,IAAKtB,EAAI5C,EAAIoD,GAAIR,GAAK5C,EAAIqD,KAAMT,EAC7BvM,EAAI2M,EAAM5P,YAAYwP,EAAIrE,EAAKkE,QAC3B8B,EAAMK,MAASvO,GAAK,EAAM2J,EAAIoD,GAAKR,EAAE,GACrC5C,EAAIqE,QAAOrE,EAAIqE,MAAMzB,GAAKvM,GAC9B2J,EAAIkE,IAAItB,GAAK2B,EAAML,IAAI7N,GACnBkI,EAAKgE,WAAUvC,EAAIkE,IAAItB,GAAKnP,KAAKK,MAAMkM,EAAIkE,IAAItB,KAE/CrE,EAAKmG,QACF1E,EAAIkE,IAAItB,IAAMxI,EAAMyK,WAAY7E,EAAIoD,GAAKR,EAAG5C,EAAIkE,IAAItB,IAAMxI,EAAMyK,UAChE7E,EAAIkE,IAAItB,GAAKxI,EAAMyK,WAAY7E,EAAIqD,GAAKT,EAAG5C,EAAIkE,IAAItB,GAAKxI,EAAMyK,YAUxE,IANItG,EAAKmG,OAAUzB,EAAO,IAClBjD,EAAIoD,GAAKpD,EAAIqD,GAAG,GAAOrD,EAAIkE,IAAIlE,EAAIoD,KAAOpD,EAAIkE,IAAIlE,EAAIoD,GAAG,IAAKpD,EAAIoD,KAClEpD,EAAIoD,GAAKpD,EAAIqD,GAAG,GAAOrD,EAAIkE,IAAIlE,EAAIqD,GAAG,IAAMrD,EAAIkE,IAAIlE,EAAIqD,KAAMrD,EAAIqD,MAIlEJ,EAAO,GAAOL,EAAI5C,EAAIqD,GAAKrD,EAAIyD,MAAQ,GAC5CzD,EAAIkE,IAAItB,KAAO5C,EAAIkE,IAAIlE,EAAIqD,IAK9B,IAFAlQ,KAAKwL,OAASxL,KAAKuL,OAASvL,KAAK0L,UAAY,KAExC8D,EAAI3C,EAAIkD,GAAIP,EAAI3C,EAAImD,GAAIR,GAAK3C,EAAIwD,MACnC,IAAKZ,EAAI5C,EAAIoD,GAAIR,EAAI5C,EAAIqD,GAAIT,GAAK5C,EAAIyD,MAEnC,GADAZ,EAAOjO,EAAMa,cAAckN,EAAI,EAAGC,EAAI,GACjCzC,OAAOC,SAASyC,GAErB,IADA7C,EAAI2D,MAAQd,EACRtE,EAAK+F,cAAe,CAErB,GADAxB,GAAW9C,EAAIgE,IAAIrB,EAAE3C,EAAIwD,OAAOxD,EAAIgE,IAAIrB,KAAK3C,EAAIkE,IAAItB,GAAG5C,EAAIkE,IAAItB,EAAE5C,EAAIyD,QAClEX,GAAW,EAAG,SAClB9C,EAAI/M,IAAMQ,KAAKR,IAAI+M,EAAI/M,IAAK4P,GACvBA,EAAK,IAAQA,EAAK7C,EAAIhN,KAAmB,IAAVgN,EAAIhN,OAAWgN,EAAIhN,IAAM6P,GAC7DA,GAAYC,CACd,CACiB,OAAd3P,KAAKwL,OACNxL,KAAKwL,OAASxL,KAAKuL,OAASmE,GAE5B1P,KAAKwL,OAASlL,KAAKR,IAAIE,KAAKwL,OAAQkE,GACpC1P,KAAKuL,OAASjL,KAAKT,IAAIG,KAAKuL,OAAQmE,IAEnCA,EAAO,IACc,OAAjB1P,KAAK0L,WAAsBgE,EAAK1P,KAAK0L,aAAY1L,KAAK0L,UAAYgE,GAIhF7C,SAAI1B,QAAUlE,EAAM0K,iBAEhB9E,EAAI1B,SACLnL,KAAKkL,cAAcjE,EAAO4F,EAAI1B,QAASC,GAEnCyB,CACT,EApyBsC","names":["assignRAxisMethods","axis","_typename","fInvBinWidth","$dummy","fNBinsNoOver","fLow","min","max","GetNumBins","this","GetBinCoord","bin","FindBin","x","add","Math","floor","fBinBorders","length","indx","round","indx2","abs","k","GetBinCenter","GetBinLowEdge","getHImpl","obj","fHistImpl","fIO","RHistPainter","RObjectPainter","constructor","dom","histo","super","csstype","draw_content","nbinsx","nbinsy","accept_drops","mode3d","getHisto","isDisplayItem","getObject","fAxes","force","getBinContent","nx","fIndicies","dx","stepx","ny","dy","stepy","nz","dz","stepz","getBin","y","z","getBin0","fBinContent","getBinError","sqrt","_2","_0","_1","fStatistics","fSumWeightsSquared","decodeOptions","options","Hist","copyOptionsFrom","src","Mode3D","copyOptionsToOthers","forEachPainter","painter","clear3DScene","fp","getFramePainter","create3DScene","cleanup","getDimension","scanContent","drawFrameAxes","main","isMainPainter","cleanupAxes","xmin","xmax","ymin","ymax","zmin","zmax","setAxesRanges","getAxis","drawAxes","second_x","second_y","setAxes2Ranges","drawAxes2","Promise","resolve","createHistDrawAttributes","createv7AttFill","createv7AttLine","updateDisplayItem","fContMin","fContMinPos","fContMax","updateObject","origin","matchObjectType","horigin","hobj","fTitle","histogram_updated","name","getAxisBinTip","step","pmain","handle","x1","kind","axisAsText","x2","extractAxesProperties","ndim","nbinsz","addInteractivity","ismain","second_axis","processItemReply","reply","req","console","error","reqid","current_item_reqid","item","resolveFunc","drawingBins","reason","is_axes_zoomed","indexOf","v7NormalMode","prepareDraw","only_indexes","incomplete","v7SubmitRequest","bind","setTimeout","toggleStat","getSelectIndex","size","taxis","nbins","autoZoom","clickButton","funcname","zoom_xmin","zoom_xmax","zoom_ymin","zoom_ymax","zoom_zmin","zoom_zmax","unzoom","zoomChangedInteractive","toggleAxisLog","fillToolbar","not_shown","pp","getPadPainter","addPadButton","showPadButtons","get3DToolTip","tip","fName","title","ix","iy","value","lines","getBinTooltips","iz","createContour","palette","args","nlevels","gStyle","minbin","maxbin","zminpos","minposbin","scatter_plot","gminbin","gmaxbin","gminposbin","full_z_range","setFullRange","logz","scale_zmin","colzmin","scale_zmax","colzmax","changeValuesRange","menu","arg","prefix","isAxisZoomed","input","then","res","JSON","parse","Number","isFinite","zoom","fillContextMenu","addchk","fillHistContextMenu","getMainPainter","isTooltipAllowed","setTooltipAllowed","enable_highlight","highlightBin3D","render3D","FrontBox","BackBox","Zero","redrawPad","Lego","fillPaletteMenu","control","_main$control","reset","addAttributesMenu","updatePaletteDraw","findPainterFor","undefined","drawPalette","addPaletteMenu","Palette","settings","parseInt","redraw","toggleMode3D","Surf","Error","Color","interactiveRedraw","rounding","extra","middle","right_extra","i","j","binz","binarea","xaxis","yaxis","hdim","i1","i2","j1","j2","k1","k2","stepi","stepj","stepk","sumz","xbar1","xbar2","ybar1","ybar2","grx","Array","gry","original","origx","origy","pixel_density","funcs","getGrFuncs","logx","use3d","size_x3d","logy","size_y3d","getHistPalette"],"sourceRoot":"webpack:///","sources":["../../node_modules/jsroot/modules/hist2d/RHistPainter.mjs"],"sourcesContent":["import { gStyle, settings } from '../core.mjs';\nimport { RObjectPainter } from '../base/RObjectPainter.mjs';\n\n\n/** @summary assign methods for the RAxis objects\n  * @private */\nfunction assignRAxisMethods(axis) {\n   if ((axis._typename == \"ROOT::Experimental::RAxisEquidistant\") || (axis._typename == \"ROOT::Experimental::RAxisLabels\")) {\n      if (axis.fInvBinWidth === 0) {\n         axis.$dummy = true;\n         axis.fInvBinWidth = 1;\n         axis.fNBinsNoOver = 0;\n         axis.fLow = 0;\n      }\n\n      axis.min = axis.fLow;\n      axis.max = axis.fLow + axis.fNBinsNoOver/axis.fInvBinWidth;\n      axis.GetNumBins = function() { return this.fNBinsNoOver; }\n      axis.GetBinCoord = function(bin) { return this.fLow + bin/this.fInvBinWidth; }\n      axis.FindBin = function(x,add) { return Math.floor((x - this.fLow)*this.fInvBinWidth + add); }\n   } else if (axis._typename == \"ROOT::Experimental::RAxisIrregular\") {\n      axis.min = axis.fBinBorders[0];\n      axis.max = axis.fBinBorders[axis.fBinBorders.length - 1];\n      axis.GetNumBins = function() { return this.fBinBorders.length; }\n      axis.GetBinCoord = function(bin) {\n         let indx = Math.round(bin);\n         if (indx <= 0) return this.fBinBorders[0];\n         if (indx >= this.fBinBorders.length) return this.fBinBorders[this.fBinBorders.length - 1];\n         if (indx==bin) return this.fBinBorders[indx];\n         let indx2 = (bin < indx) ? indx - 1 : indx + 1;\n         return this.fBinBorders[indx] * Math.abs(bin-indx2) + this.fBinBorders[indx2] * Math.abs(bin-indx);\n      }\n      axis.FindBin = function(x,add) {\n         for (let k = 1; k < this.fBinBorders.length; ++k)\n            if (x < this.fBinBorders[k]) return Math.floor(k-1+add);\n         return this.fBinBorders.length - 1;\n      }\n   }\n\n   // to support some code from ROOT6 drawing\n\n   axis.GetBinCenter = function(bin) { return this.GetBinCoord(bin-0.5); }\n   axis.GetBinLowEdge = function(bin) { return this.GetBinCoord(bin-1); }\n}\n\n/** @summary Returns real histogram impl\n  * @private */\nfunction getHImpl(obj) {\n   return (obj && obj.fHistImpl) ? obj.fHistImpl.fIO : null;\n}\n\n\n/** @summary Base painter class for RHist objects\n *\n * @private\n */\n\nclass RHistPainter extends RObjectPainter {\n\n   /** @summary Constructor\n     * @param {object|string} dom - DOM element for drawing or element id\n     * @param {object} histo - RHist object */\n   constructor(dom, histo) {\n      super(dom, histo);\n      this.csstype = \"hist\";\n      this.draw_content = true;\n      this.nbinsx = 0;\n      this.nbinsy = 0;\n      this.accept_drops = true; // indicate that one can drop other objects like doing Draw(\"same\")\n      this.mode3d = false;\n\n      // initialize histogram methods\n      this.getHisto(true);\n   }\n\n   /** @summary Returns true if RHistDisplayItem is used */\n   isDisplayItem() {\n      let obj = this.getObject();\n      return obj && obj.fAxes ? true : false;\n   }\n\n   /** @summary get histogram */\n   getHisto(force) {\n      let obj = this.getObject(), histo = getHImpl(obj);\n\n      if (histo && (!histo.getBinContent || force)) {\n         if (histo.fAxes._2) {\n            assignRAxisMethods(histo.fAxes._0);\n            assignRAxisMethods(histo.fAxes._1);\n            assignRAxisMethods(histo.fAxes._2);\n            histo.getBin = function(x, y, z) { return (x-1) + this.fAxes._0.GetNumBins()*(y-1) + this.fAxes._0.GetNumBins()*this.fAxes._1.GetNumBins()*(z-1); }\n            // FIXME: all normal ROOT methods uses indx+1 logic, but RHist has no underflow/overflow bins now\n            histo.getBinContent = function(x, y, z) { return this.fStatistics.fBinContent[this.getBin(x, y, z)]; }\n            histo.getBinError = function(x, y, z) {\n               let bin = this.getBin(x, y, z);\n               if (this.fStatistics.fSumWeightsSquared)\n                  return Math.sqrt(this.fStatistics.fSumWeightsSquared[bin]);\n               return Math.sqrt(Math.abs(this.fStatistics.fBinContent[bin]));\n            }\n         } else if (histo.fAxes._1) {\n            assignRAxisMethods(histo.fAxes._0);\n            assignRAxisMethods(histo.fAxes._1);\n            histo.getBin = function(x, y) { return (x-1) + this.fAxes._0.GetNumBins()*(y-1); }\n            // FIXME: all normal ROOT methods uses indx+1 logic, but RHist has no underflow/overflow bins now\n            histo.getBinContent = function(x, y) { return this.fStatistics.fBinContent[this.getBin(x, y)]; }\n            histo.getBinError = function(x, y) {\n               let bin = this.getBin(x, y);\n               if (this.fStatistics.fSumWeightsSquared)\n                  return Math.sqrt(this.fStatistics.fSumWeightsSquared[bin]);\n               return Math.sqrt(Math.abs(this.fStatistics.fBinContent[bin]));\n            }\n         } else {\n            assignRAxisMethods(histo.fAxes._0);\n            histo.getBin = function(x) { return x-1; }\n            // FIXME: all normal ROOT methods uses indx+1 logic, but RHist has no underflow/overflow bins now\n            histo.getBinContent = function(x) { return this.fStatistics.fBinContent[x-1]; }\n            histo.getBinError = function(x) {\n               if (this.fStatistics.fSumWeightsSquared)\n                  return Math.sqrt(this.fStatistics.fSumWeightsSquared[x-1]);\n               return Math.sqrt(Math.abs(this.fStatistics.fBinContent[x-1]));\n            }\n         }\n      } else if (!histo && obj && obj.fAxes) {\n         // case of RHistDisplayItem\n\n         histo = obj;\n\n         if (!histo.getBinContent || force) {\n            if (histo.fAxes.length == 3) {\n               assignRAxisMethods(histo.fAxes[0]);\n               assignRAxisMethods(histo.fAxes[1]);\n               assignRAxisMethods(histo.fAxes[2]);\n\n               histo.nx = histo.fIndicies[1] - histo.fIndicies[0];\n               histo.dx = histo.fIndicies[0] + 1;\n               histo.stepx = histo.fIndicies[2];\n\n               histo.ny = histo.fIndicies[4] - histo.fIndicies[3];\n               histo.dy = histo.fIndicies[3] + 1;\n               histo.stepy = histo.fIndicies[5];\n\n               histo.nz = histo.fIndicies[7] - histo.fIndicies[6];\n               histo.dz = histo.fIndicies[6] + 1;\n               histo.stepz = histo.fIndicies[8];\n\n               // this is index in original histogram\n               histo.getBin = function(x, y, z) { return (x-1) + this.fAxes[0].GetNumBins()*(y-1) + this.fAxes[0].GetNumBins()*this.fAxes[1].GetNumBins()*(z-1); }\n\n               // this is index in current available data\n               if ((histo.stepx > 1) || (histo.stepy > 1) || (histo.stepz > 1))\n                  histo.getBin0 = function(x, y, z) { return Math.floor((x-this.dx)/this.stepx) + this.nx/this.stepx*Math.floor((y-this.dy)/this.stepy) + this.nx/this.stepx*this.ny/this.stepy*Math.floor((z-this.dz)/this.stepz); }\n               else\n                  histo.getBin0 = function(x, y, z) { return (x-this.dx) + this.nx*(y-this.dy) + this.nx*this.ny*(z-dz); }\n\n               histo.getBinContent = function(x, y, z) { return this.fBinContent[this.getBin0(x, y, z)]; }\n               histo.getBinError = function(x, y, z) { return Math.sqrt(Math.abs(this.getBinContent(x, y, z))); }\n\n\n            } else if (histo.fAxes.length == 2) {\n               assignRAxisMethods(histo.fAxes[0]);\n               assignRAxisMethods(histo.fAxes[1]);\n\n               histo.nx = histo.fIndicies[1] - histo.fIndicies[0];\n               histo.dx = histo.fIndicies[0] + 1;\n               histo.stepx = histo.fIndicies[2];\n\n               histo.ny = histo.fIndicies[4] - histo.fIndicies[3];\n               histo.dy = histo.fIndicies[3] + 1;\n               histo.stepy = histo.fIndicies[5];\n\n               // this is index in original histogram\n               histo.getBin = function(x, y) { return (x-1) + this.fAxes[0].GetNumBins()*(y-1); }\n\n               // this is index in current available data\n               if ((histo.stepx > 1) || (histo.stepy > 1))\n                  histo.getBin0 = function(x, y) { return Math.floor((x-this.dx)/this.stepx) + this.nx/this.stepx*Math.floor((y-this.dy)/this.stepy); }\n               else\n                  histo.getBin0 = function(x, y) { return (x-this.dx) + this.nx*(y-this.dy); }\n\n               histo.getBinContent = function(x, y) { return this.fBinContent[this.getBin0(x, y)]; }\n               histo.getBinError = function(x, y) { return Math.sqrt(Math.abs(this.getBinContent(x, y))); }\n            } else {\n               assignRAxisMethods(histo.fAxes[0]);\n               histo.nx = histo.fIndicies[1] - histo.fIndicies[0];\n               histo.dx = histo.fIndicies[0] + 1;\n               histo.stepx = histo.fIndicies[2];\n\n               histo.getBin = function(x) { return x-1; }\n               if (histo.stepx > 1)\n                  histo.getBin0 = function(x) { return Math.floor((x-this.dx)/this.stepx); }\n               else\n                  histo.getBin0 = function(x) { return x-this.dx; }\n               histo.getBinContent = function(x) { return this.fBinContent[this.getBin0(x)]; }\n               histo.getBinError = function(x) { return Math.sqrt(Math.abs(this.getBinContent(x))); }\n            }\n         }\n      }\n      return histo;\n   }\n\n   /** @summary Decode options */\n   decodeOptions(/*opt*/) {\n      if (!this.options) this.options = { Hist : 1 };\n   }\n\n   /** @summary Copy draw options from other painter */\n   copyOptionsFrom(src) {\n      if (src === this) return;\n      let o = this.options, o0 = src.options;\n      o.Mode3D = o0.Mode3D;\n   }\n\n   /** @summary copy draw options to all other histograms in the pad*/\n   copyOptionsToOthers() {\n      this.forEachPainter(painter => {\n         if ((painter !== this) && (typeof painter.copyOptionsFrom == 'function'))\n            painter.copyOptionsFrom(this);\n      }, \"objects\");\n   }\n\n   /** @summary Clear 3d drawings - if any */\n   clear3DScene() {\n      let fp = this.getFramePainter();\n      if (typeof fp?.create3DScene === 'function')\n         fp.create3DScene(-1);\n      this.mode3d = false;\n   }\n\n   /** @summary Cleanup hist painter */\n   cleanup() {\n      this.clear3DScene();\n\n      delete this.options;\n\n      super.cleanup();\n   }\n\n   /** @summary Returns histogram dimension */\n   getDimension() { return 1; }\n\n   /** @summary Scan histogram content\n     * @abstract */\n   scanContent(/*when_axis_changed*/) {\n      // function will be called once new histogram or\n      // new histogram content is assigned\n      // one should find min,max,nbins, maxcontent values\n      // if when_axis_changed === true specified, content will be scanned after axis zoom changed\n   }\n\n   /** @summary Draw axes */\n   drawFrameAxes() {\n      // return true when axes was drawn\n      let main = this.getFramePainter();\n      if (!main)\n         return Promise.resolve(false);\n\n      if (!this.draw_content)\n         return Promise.resolve(true);\n\n      if (!this.isMainPainter()) {\n         if (!this.options.second_x && !this.options.second_y)\n            return Promise.resolve(true);\n\n         main.setAxes2Ranges(this.options.second_x, this.getAxis(\"x\"), this.xmin, this.xmax, this.options.second_y, this.getAxis(\"y\"), this.ymin, this.ymax);\n         return main.drawAxes2(this.options.second_x, this.options.second_y);\n      }\n\n      main.cleanupAxes();\n      main.xmin = main.xmax = 0;\n      main.ymin = main.ymax = 0;\n      main.zmin = main.zmax = 0;\n      main.setAxesRanges(this.getAxis(\"x\"), this.xmin, this.xmax, this.getAxis(\"y\"), this.ymin, this.ymax, this.getAxis(\"z\"), this.zmin, this.zmax);\n      return main.drawAxes();\n   }\n\n   /** @summary create attributes */\n   createHistDrawAttributes() {\n      this.createv7AttFill();\n      this.createv7AttLine();\n   }\n\n   /** @summary update display item */\n   updateDisplayItem(obj, src) {\n      if (!obj || !src) return false;\n\n      obj.fAxes = src.fAxes;\n      obj.fIndicies = src.fIndicies;\n      obj.fBinContent = src.fBinContent;\n      obj.fContMin = src.fContMin;\n      obj.fContMinPos = src.fContMinPos;\n      obj.fContMax = src.fContMax;\n\n      // update histogram attributes\n      this.getHisto(true);\n\n      return true;\n   }\n\n   /** @summary update histogram object */\n   updateObject(obj /*, opt*/) {\n\n      let origin = this.getObject();\n\n      if (obj !== origin) {\n\n         if (!this.matchObjectType(obj)) return false;\n\n         if (this.isDisplayItem()) {\n\n            this.updateDisplayItem(origin, obj);\n\n         } else {\n\n            let horigin = getHImpl(origin),\n                hobj = getHImpl(obj);\n\n            if (!horigin || !hobj) return false;\n\n            // make it easy - copy statistics without axes\n            horigin.fStatistics = hobj.fStatistics;\n\n            origin.fTitle = obj.fTitle;\n         }\n      }\n\n      this.scanContent();\n\n      this.histogram_updated = true; // indicate that object updated\n\n      return true;\n   }\n\n   /** @summary Get axis object */\n   getAxis(name) {\n      let histo = this.getHisto(), obj = this.getObject(), axis = null;\n\n      if (obj && obj.fAxes) {\n         switch(name) {\n            case \"x\": axis = obj.fAxes[0]; break;\n            case \"y\": axis = obj.fAxes[1]; break;\n            case \"z\": axis = obj.fAxes[2]; break;\n            default: axis = obj.fAxes[0]; break;\n         }\n      } else if (histo && histo.fAxes) {\n         // console.log('histo fAxes', histo.fAxes, histo.fAxes._0)\n         switch(name) {\n            case \"x\": axis = histo.fAxes._0; break;\n            case \"y\": axis = histo.fAxes._1; break;\n            case \"z\": axis = histo.fAxes._2; break;\n            default: axis = histo.fAxes._0; break;\n         }\n      }\n\n      if (axis && !axis.GetBinCoord)\n         assignRAxisMethods(axis);\n\n      return axis;\n   }\n\n   /** @summary Get tip text for axis bin */\n   getAxisBinTip(name, bin, step) {\n      let pmain = this.getFramePainter(),\n          handle = pmain[name+\"_handle\"],\n          axis = this.getAxis(name),\n          x1 = axis.GetBinCoord(bin);\n\n      if (handle.kind === 'labels')\n         return pmain.axisAsText(name, x1);\n\n      let x2 = axis.GetBinCoord(bin+(step || 1));\n\n      if (handle.kind === 'time')\n         return pmain.axisAsText(name, (x1+x2)/2);\n\n      return \"[\" + pmain.axisAsText(name, x1) + \", \" + pmain.axisAsText(name, x2) + \")\";\n   }\n\n   /** @summary Extract axes ranges and bins numbers\n     * @desc Also here ensured that all axes objects got their necessary methods */\n   extractAxesProperties(ndim) {\n\n      let histo = this.getHisto();\n      if (!histo) return;\n\n      this.nbinsx = this.nbinsy = this.nbinsz = 0;\n\n      let axis = this.getAxis(\"x\");\n      this.nbinsx = axis.GetNumBins();\n      this.xmin = axis.min;\n      this.xmax = axis.max;\n\n      if (ndim < 2) return;\n      axis = this.getAxis(\"y\");\n      this.nbinsy = axis.GetNumBins();\n      this.ymin = axis.min;\n      this.ymax = axis.max;\n\n      if (ndim < 3) return;\n      axis = this.getAxis(\"z\");\n      this.nbinsz = axis.GetNumBins();\n      this.zmin = axis.min;\n      this.zmax = axis.max;\n   }\n\n   /** @summary Add interactive features, only main painter does it */\n   addInteractivity() {\n      // only first painter in list allowed to add interactive functionality to the frame\n\n      let ismain =  this.isMainPainter(),\n          second_axis = this.options.second_x || this.options.second_y,\n          fp = ismain || second_axis ? this.getFramePainter() : null;\n      return fp ? fp.addInteractivity(!ismain && second_axis) : true;\n   }\n\n   /** @summary Process item reply */\n   processItemReply(reply, req) {\n      if (!this.isDisplayItem())\n         return console.error('Get item when display normal histogram');\n\n      if (req.reqid === this.current_item_reqid) {\n\n         if (reply !== null) {\n            this.updateDisplayItem(this.getObject(), reply.item);\n         }\n\n         req.resolveFunc(true);\n      }\n   }\n\n   /** @summary Special method to request bins from server if existing data insufficient\n     * @returns {Promise} when ready */\n   drawingBins(reason) {\n\n      let is_axes_zoomed = false;\n      if (reason && (typeof reason == \"string\") && (reason.indexOf(\"zoom\") == 0)) {\n         if (reason.indexOf(\"0\") > 0) is_axes_zoomed = true;\n         if ((this.getDimension() > 1) && (reason.indexOf(\"1\") > 0)) is_axes_zoomed = true;\n         if ((this.getDimension() > 2) && (reason.indexOf(\"2\") > 0)) is_axes_zoomed = true;\n      }\n\n      if (this.isDisplayItem() && is_axes_zoomed && this.v7NormalMode()) {\n\n         let handle = this.prepareDraw({ only_indexes: true });\n\n         // submit request if histogram data not enough for display\n         if (handle.incomplete)\n            return new Promise(resolveFunc => {\n               // use empty kind to always submit request\n               let req = this.v7SubmitRequest(\"\", { _typename: \"ROOT::Experimental::RHistDrawableBase::RRequest\" },\n                                                  this.processItemReply.bind(this));\n               if (req) {\n                  this.current_item_reqid = req.reqid; // ignore all previous requests, only this one will be processed\n                  req.resolveFunc = resolveFunc;\n                  setTimeout(this.processItemReply.bind(this, null, req), 1000); // after 1 s draw something that we can\n               } else {\n                  resolveFunc(true);\n               }\n            });\n      }\n\n      return Promise.resolve(true);\n   }\n\n   /** @summary Toggle stat box drawing\n     * @desc Not yet implemented */\n   toggleStat(/*arg*/) {\n   }\n\n   /** @summary get selected index for axis */\n   getSelectIndex(axis, size, add) {\n      // be aware - here indexes starts from 0\n      let indx = 0,\n          taxis = this.getAxis(axis),\n          nbins = this['nbins'+axis] || 0;\n\n      if (this.options.second_x && axis == \"x\") axis = \"x2\";\n      if (this.options.second_y && axis == \"y\") axis = \"y2\";\n\n      let main = this.getFramePainter(),\n          min = main ? main['zoom_' + axis + 'min'] : 0,\n          max = main ? main['zoom_' + axis + 'max'] : 0;\n\n      if ((min !== max) && taxis) {\n         if (size == \"left\")\n            indx = taxis.FindBin(min, add || 0);\n         else\n            indx = taxis.FindBin(max, (add || 0) + 0.5);\n         if (indx<0) indx = 0; else if (indx>nbins) indx = nbins;\n      } else {\n         indx = (size == \"left\") ? 0 : nbins;\n      }\n\n      return indx;\n   }\n\n   /** @summary Auto zoom into histogram non-empty range\n     * @abstract */\n   autoZoom() {}\n\n   /** @summary Process click on histogram-defined buttons */\n   clickButton(funcname) {\n      // TODO: move to frame painter\n      switch(funcname) {\n         case \"ToggleZoom\":\n            if ((this.zoom_xmin !== this.zoom_xmax) || (this.zoom_ymin !== this.zoom_ymax) || (this.zoom_zmin !== this.zoom_zmax)) {\n               this.unzoom();\n               this.getFramePainter().zoomChangedInteractive('reset');\n               return true;\n            }\n            if (this.draw_content) {\n               this.autoZoom();\n               return true;\n            }\n            break;\n         case \"ToggleLogX\": this.getFramePainter().toggleAxisLog(\"x\"); break;\n         case \"ToggleLogY\": this.getFramePainter().toggleAxisLog(\"y\"); break;\n         case \"ToggleLogZ\": this.getFramePainter().toggleAxisLog(\"z\"); break;\n         case \"ToggleStatBox\": this.toggleStat(); return true;\n      }\n      return false;\n   }\n\n   /** @summary Fill pad toolbar with hist-related functions */\n   fillToolbar(not_shown) {\n      let pp = this.getPadPainter();\n      if (!pp) return;\n\n      pp.addPadButton(\"auto_zoom\", 'Toggle between unzoom and autozoom-in', 'ToggleZoom', \"Ctrl *\");\n      pp.addPadButton(\"arrow_right\", \"Toggle log x\", \"ToggleLogX\", \"PageDown\");\n      pp.addPadButton(\"arrow_up\", \"Toggle log y\", \"ToggleLogY\", \"PageUp\");\n      if (this.getDimension() > 1)\n         pp.addPadButton(\"arrow_diag\", \"Toggle log z\", \"ToggleLogZ\");\n      if (this.draw_content)\n         pp.addPadButton(\"statbox\", 'Toggle stat box', \"ToggleStatBox\");\n      if (!not_shown) pp.showPadButtons();\n   }\n\n   /** @summary get tool tips used in 3d mode */\n   get3DToolTip(indx) {\n      let histo = this.getHisto(),\n          tip = { bin: indx, name: histo.fName || \"histo\", title: histo.fTitle };\n      switch (this.getDimension()) {\n         case 1:\n            tip.ix = indx + 1; tip.iy = 1;\n            tip.value = histo.getBinContent(tip.ix);\n            tip.error = histo.getBinError(tip.ix);\n            tip.lines = this.getBinTooltips(indx-1);\n            break;\n         case 2:\n            tip.ix = (indx % this.nbinsx) + 1;\n            tip.iy = (indx - (tip.ix - 1)) / this.nbinsx + 1;\n            tip.value = histo.getBinContent(tip.ix, tip.iy);\n            tip.error = histo.getBinError(tip.ix, tip.iy);\n            tip.lines = this.getBinTooltips(tip.ix-1, tip.iy-1);\n            break;\n         case 3:\n            tip.ix = indx % this.nbinsx + 1;\n            tip.iy = ((indx - (tip.ix - 1)) / this.nbinsx) % this.nbinsy + 1;\n            tip.iz = (indx - (tip.ix - 1) - (tip.iy - 1) * this.nbinsx) / this.nbinsx / this.nbinsy + 1;\n            tip.value = histo.getBinContent(tip.ix, tip.iy, tip.iz);\n            tip.error = histo.getBinError(tip.ix, tip.iy, tip.iz);\n            tip.lines = this.getBinTooltips(tip.ix-1, tip.iy-1, tip.iz-1);\n            break;\n      }\n\n      return tip;\n   }\n\n   /** @summary Create contour levels for currently selected Z range */\n   createContour(main, palette, args) {\n      if (!main || !palette) return;\n\n      if (!args) args = {};\n\n      let nlevels = gStyle.fNumberContours,\n          zmin = this.minbin, zmax = this.maxbin, zminpos = this.minposbin;\n\n      if (args.scatter_plot) {\n         if (nlevels > 50) nlevels = 50;\n         zmin = this.minposbin;\n      }\n\n      if (zmin === zmax) { zmin = this.gminbin; zmax = this.gmaxbin; zminpos = this.gminposbin; }\n\n      if (this.getDimension() < 3) {\n         if (main.zoom_zmin !== main.zoom_zmax) {\n            zmin = main.zoom_zmin;\n            zmax = main.zoom_zmax;\n         } else if (args.full_z_range) {\n            zmin = main.zmin;\n            zmax = main.zmax;\n         }\n      }\n\n      palette.setFullRange(main.zmin, main.zmax);\n      palette.createContour(main.logz, nlevels, zmin, zmax, zminpos);\n\n      if (this.getDimension() < 3) {\n         main.scale_zmin = palette.colzmin;\n         main.scale_zmax = palette.colzmax;\n      }\n   }\n\n   /** @summary Start dialog to modify range of axis where histogram values are displayed */\n   changeValuesRange(menu, arg) {\n      let pmain = this.getFramePainter();\n      if (!pmain) return;\n      let prefix = pmain.isAxisZoomed(arg) ? \"zoom_\" + arg : arg,\n          curr = \"[\" + pmain[prefix+'min'] + \",\" + pmain[prefix+'max'] + \"]\";\n      menu.input(\"Enter values range for axis \" + arg + \" like [0,100] or empty string to unzoom\", curr).then(res => {\n         res = res ? JSON.parse(res) : [];\n         if (!res || (typeof res != \"object\") || (res.length != 2) || !Number.isFinite(res[0]) || !Number.isFinite(res[1]))\n            pmain.unzoom(arg);\n         else\n            pmain.zoom(arg, res[0], res[1]);\n      });\n   }\n\n   /** @summary Fill histogram context menu */\n   fillContextMenu(menu) {\n\n      menu.add(\"header:v7histo::anyname\");\n\n      if (this.draw_content) {\n         menu.addchk(this.toggleStat('only-check'), \"Show statbox\", () => this.toggleStat());\n\n         if (this.getDimension() == 2)\n             menu.add(\"Values range\", () => this.changeValuesRange(menu, \"z\"));\n\n         if (typeof this.fillHistContextMenu == 'function')\n            this.fillHistContextMenu(menu);\n      }\n\n      let fp = this.getFramePainter();\n\n      if (this.options.Mode3D) {\n         // menu for 3D drawings\n\n         if (menu.size() > 0)\n            menu.add(\"separator\");\n\n         let main = this.getMainPainter() || this;\n\n         menu.addchk(main.isTooltipAllowed(), 'Show tooltips', () => main.setTooltipAllowed(\"toggle\"));\n\n         menu.addchk(fp.enable_highlight, 'Highlight bins', () => {\n            fp.enable_highlight = !fp.enable_highlight;\n            if (!fp.enable_highlight && main.highlightBin3D && main.mode3d) main.highlightBin3D(null);\n         });\n\n         if (typeof fp?.render3D == 'function') {\n            menu.addchk(main.options.FrontBox, 'Front box', () => {\n               main.options.FrontBox = !main.options.FrontBox;\n               fp.render3D();\n            });\n            menu.addchk(main.options.BackBox, 'Back box', () => {\n               main.options.BackBox = !main.options.BackBox;\n               fp.render3D();\n            });\n         }\n\n         if (this.draw_content) {\n            menu.addchk(!this.options.Zero, 'Suppress zeros', () => {\n               this.options.Zero = !this.options.Zero;\n               this.redrawPad();\n            });\n\n            if ((this.options.Lego == 12) || (this.options.Lego == 14)) {\n               if (this.fillPaletteMenu)\n                  this.fillPaletteMenu(menu);\n            }\n         }\n\n         if (typeof main.control?.reset === 'function')\n            menu.add('Reset camera', () => main.control.reset());\n      }\n\n      menu.addAttributesMenu(this);\n\n      if (this.histogram_updated && fp.zoomChangedInteractive())\n         menu.add('Let update zoom', () => fp.zoomChangedInteractive('reset'));\n\n      return true;\n   }\n\n   /** @summary Update palette drawing */\n   updatePaletteDraw() {\n      if (this.isMainPainter())\n         this.getPadPainter().findPainterFor(undefined, undefined, \"ROOT::Experimental::RPaletteDrawable\")?.drawPalette();\n   }\n\n   /** @summary Fill menu entries for palette */\n   fillPaletteMenu(menu) {\n      menu.addPaletteMenu(this.options.Palette || settings.Palette, arg => {\n         // TODO: rewrite for RPalette functionality\n         this.options.Palette = parseInt(arg);\n         this.redraw(); // redraw histogram\n      });\n   }\n\n   /** @summary Toggle 3D drawing mode */\n   toggleMode3D() {\n      this.options.Mode3D = !this.options.Mode3D;\n\n      if (this.options.Mode3D) {\n         if (!this.options.Surf && !this.options.Lego && !this.options.Error) {\n            if ((this.nbinsx>=50) || (this.nbinsy>=50))\n               this.options.Lego = this.options.Color ? 14 : 13;\n            else\n               this.options.Lego = this.options.Color ? 12 : 1;\n\n            this.options.Zero = false; // do not show zeros by default\n         }\n      }\n\n      this.copyOptionsToOthers();\n      this.interactiveRedraw(\"pad\", \"drawopt\");\n   }\n\n   /** @summary Calculate histogram inidicies and axes values for each visible bin */\n   prepareDraw(args) {\n\n      if (!args) args = { rounding: true, extra: 0, middle: 0 };\n\n      if (args.extra === undefined) args.extra = 0;\n      if (args.right_extra === undefined) args.right_extra = args.extra;\n      if (args.middle === undefined) args.middle = 0;\n\n      let histo = this.getHisto(), xaxis = this.getAxis(\"x\"), yaxis = this.getAxis(\"y\"),\n          pmain = this.getFramePainter(),\n          hdim = this.getDimension(),\n          i, j, x, y, binz, binarea,\n          res = {\n             i1: this.getSelectIndex(\"x\", \"left\", 0 - args.extra),\n             i2: this.getSelectIndex(\"x\", \"right\", 1 + args.right_extra),\n             j1: (hdim < 2) ? 0 : this.getSelectIndex(\"y\", \"left\", 0 - args.extra),\n             j2: (hdim < 2) ? 1 : this.getSelectIndex(\"y\", \"right\", 1 + args.right_extra),\n             k1: (hdim < 3) ? 0 : this.getSelectIndex(\"z\", \"left\", 0 - args.extra),\n             k2: (hdim < 3) ? 1 : this.getSelectIndex(\"z\", \"right\", 1 + args.right_extra),\n             stepi: 1, stepj: 1, stepk: 1,\n             min: 0, max: 0, sumz: 0, xbar1: 0, xbar2: 1, ybar1: 0, ybar2: 1\n          };\n\n      if (this.isDisplayItem() && histo.fIndicies) {\n         if (res.i1 < histo.fIndicies[0]) { res.i1 = histo.fIndicies[0]; res.incomplete = true; }\n         if (res.i2 > histo.fIndicies[1]) { res.i2 = histo.fIndicies[1]; res.incomplete = true; }\n         res.stepi = histo.fIndicies[2];\n         if (res.stepi > 1) res.incomplete = true;\n         if ((hdim > 1) && (histo.fIndicies.length > 5)) {\n            if (res.j1 < histo.fIndicies[3]) { res.j1 = histo.fIndicies[3]; res.incomplete = true; }\n            if (res.j2 > histo.fIndicies[4]) { res.j2 = histo.fIndicies[4]; res.incomplete = true; }\n            res.stepj = histo.fIndicies[5];\n            if (res.stepj > 1) res.incomplete = true;\n         }\n         if ((hdim > 2) && (histo.fIndicies.length > 8)) {\n            if (res.k1 < histo.fIndicies[6]) { res.k1 = histo.fIndicies[6]; res.incomplete = true; }\n            if (res.k2 > histo.fIndicies[7]) { res.k2 = histo.fIndicies[7]; res.incomplete = true; }\n            res.stepk = histo.fIndicies[8];\n            if (res.stepk > 1) res.incomplete = true;\n         }\n      }\n\n      if (args.only_indexes) return res;\n\n      // no need for Float32Array, plain Array is 10% faster\n      // reserve more places to avoid complex boundary checks\n\n      res.grx = new Array(res.i2+res.stepi+1);\n      res.gry = new Array(res.j2+res.stepj+1);\n\n      if (args.original) {\n         res.original = true;\n         res.origx = new Array(res.i2+1);\n         res.origy = new Array(res.j2+1);\n      }\n\n      if (args.pixel_density) args.rounding = true;\n\n      let funcs = pmain.getGrFuncs(this.options.second_x, this.options.second_y);\n\n       // calculate graphical coordinates in advance\n      for (i = res.i1; i <= res.i2; ++i) {\n         x = xaxis.GetBinCoord(i + args.middle);\n         if (funcs.logx && (x <= 0)) { res.i1 = i+1; continue; }\n         if (res.origx) res.origx[i] = x;\n         res.grx[i] = funcs.grx(x);\n         if (args.rounding) res.grx[i] = Math.round(res.grx[i]);\n\n         if (args.use3d) {\n            if (res.grx[i] < -pmain.size_x3d) { res.i1 = i; res.grx[i] = -pmain.size_x3d; }\n            if (res.grx[i] > pmain.size_x3d) { res.i2 = i; res.grx[i] = pmain.size_x3d; }\n         }\n      }\n\n      if (args.use3d) {\n         if ((res.i1 < res.i2-2) && (res.grx[res.i1] == res.grx[res.i1+1])) res.i1++;\n         if ((res.i1 < res.i2-2) && (res.grx[res.i2-1] == res.grx[res.i2])) res.i2--;\n      }\n\n      // copy last valid value to higher indicies\n      while (i < res.i2 + res.stepi + 1)\n         res.grx[i++] = res.grx[res.i2];\n\n      if (hdim === 1) {\n         res.gry[0] = funcs.gry(0);\n         res.gry[1] = funcs.gry(1);\n      } else\n      for (j = res.j1; j <= res.j2; ++j) {\n         y = yaxis.GetBinCoord(j + args.middle);\n         if (funcs.logy && (y <= 0)) { res.j1 = j+1; continue; }\n         if (res.origy) res.origy[j] = y;\n         res.gry[j] = funcs.gry(y);\n         if (args.rounding) res.gry[j] = Math.round(res.gry[j]);\n\n         if (args.use3d) {\n            if (res.gry[j] < -pmain.size_y3d) { res.j1 = j; res.gry[j] = -pmain.size_y3d; }\n            if (res.gry[j] > pmain.size_y3d) { res.j2 = j; res.gry[j] = pmain.size_y3d; }\n         }\n      }\n\n      if (args.use3d && (hdim > 1)) {\n         if ((res.j1 < res.j2-2) && (res.gry[res.j1] == res.gry[res.j1+1])) res.j1++;\n         if ((res.j1 < res.j2-2) && (res.gry[res.j2-1] == res.gry[res.j2])) res.j2--;\n      }\n\n      // copy last valid value to higher indicies\n      while ((hdim > 1) && (j < res.j2 + res.stepj + 1))\n         res.gry[j++] = res.gry[res.j2];\n\n      //  find min/max values in selected range\n      this.maxbin = this.minbin = this.minposbin = null;\n\n      for (i = res.i1; i < res.i2; i += res.stepi) {\n         for (j = res.j1; j < res.j2; j += res.stepj) {\n            binz = histo.getBinContent(i + 1, j + 1);\n            if (!Number.isFinite(binz)) continue;\n            res.sumz += binz;\n            if (args.pixel_density) {\n               binarea = (res.grx[i+res.stepi]-res.grx[i])*(res.gry[j]-res.gry[j+res.stepj]);\n               if (binarea <= 0) continue;\n               res.max = Math.max(res.max, binz);\n               if ((binz>0) && ((binz<res.min) || (res.min===0))) res.min = binz;\n               binz = binz/binarea;\n            }\n            if (this.maxbin===null) {\n               this.maxbin = this.minbin = binz;\n            } else {\n               this.maxbin = Math.max(this.maxbin, binz);\n               this.minbin = Math.min(this.minbin, binz);\n            }\n            if (binz > 0)\n               if ((this.minposbin===null) || (binz<this.minposbin)) this.minposbin = binz;\n         }\n      }\n\n      res.palette = pmain.getHistPalette();\n\n      if (res.palette)\n         this.createContour(pmain, res.palette, args);\n\n      return res;\n   }\n\n} // class RHistPainter\n\n\nexport { RHistPainter }\n"],"x_google_ignoreList":[0]}