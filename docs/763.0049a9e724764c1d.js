"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[763],{5763:(pt,V,O)=>{O.r(V),O.d(V,{TGraph2DPainter:()=>K});var W=O(4882),D=O(8872),C=O(2923),ct=O(2843),dt=O(1922),ut=O(4355),Xt=O(9997),v=O(3847),tt=O(8537);function it(z){let i=z[0];for(let h=1;h<z.length;++h)i=Math.max(i,z[h]);return i}function st(z){let i=z[0];for(let h=1;h<z.length;++h)i=Math.min(i,z[h]);return i}class Yt{constructor(i){this.fGraph2D=i,this.fX=i.fX,this.fY=i.fY,this.fZ=i.fZ,this.fNpoints=i.fNpoints,this.fZout=0,this.fNdt=0,this.fNhull=0,this.fHullPoints=null,this.fXN=null,this.fYN=null,this.fOrder=null,this.fDist=null,this.fPTried=null,this.fNTried=null,this.fMTried=null,this.fInit=!1,this.fXNmin=0,this.fXNmax=0,this.fYNmin=0,this.fYNmax=0,this.fXoffset=0,this.fYoffset=0,this.fXScaleFactor=0,this.fYScaleFactor=0,this.SetMaxIter()}Initialize(){this.fInit||(this.CreateTrianglesDataStructure(),this.FindHull(),this.fInit=!0)}ComputeZ(i,h){this.Initialize();const s=(i+this.fXoffset)*this.fXScaleFactor,t=(h+this.fYoffset)*this.fYScaleFactor;let N=this.Interpolate(s,t);return 0===N&&(N=this.Interpolate(s+1e-4,t)),N}CreateTrianglesDataStructure(){const i=it(this.fGraph2D.fX),h=it(this.fGraph2D.fY),s=st(this.fGraph2D.fX),t=st(this.fGraph2D.fY);this.fXoffset=-(i+s)/2,this.fYoffset=-(h+t)/2,this.fXScaleFactor=1/(i-s),this.fYScaleFactor=1/(h-t),this.fXNmax=(i+this.fXoffset)*this.fXScaleFactor,this.fXNmin=(s+this.fXoffset)*this.fXScaleFactor,this.fYNmax=(h+this.fYoffset)*this.fYScaleFactor,this.fYNmin=(t+this.fYoffset)*this.fYScaleFactor,this.fXN=new Array(this.fNpoints+1),this.fYN=new Array(this.fNpoints+1);for(let N=0;N<this.fNpoints;N++)this.fXN[N+1]=(this.fX[N]+this.fXoffset)*this.fXScaleFactor,this.fYN[N+1]=(this.fY[N]+this.fYoffset)*this.fYScaleFactor;this.fPTried=[],this.fNTried=[],this.fMTried=[]}Enclose(i,h,s,t){const N=[this.fXN[i],this.fXN[h],this.fXN[s],this.fXN[i]],r=[this.fYN[i],this.fYN[h],this.fYN[s],this.fYN[i]],o=this.fXN[t],n=this.fYN[t];let m=0,X=N.length-1,M=!1;for(;m<N.length;++m)(r[m]<n&&r[X]>=n||r[X]<n&&r[m]>=n)&&N[m]+(n-r[m])/(r[X]-r[m])*(N[X]-N[m])<o&&(M=!M),X=m;return M}FileIt(i,h,s){let t,N,r=i,o=h,n=s;do{t=!1,o>r&&(N=r,r=o,o=N,t=!0),n>o&&(N=o,o=n,n=N,t=!0)}while(t);this.fNdt++,this.fPTried.push(r),this.fNTried.push(o),this.fMTried.push(n)}FindAllTriangles(){if(this.fAllTri)return;this.fAllTri=!0;let i,h,s,t,N,r,o,n,m,X,M,a,e,l,d,f,c,T,y,u,Y,_,x,E,g,P=0,p=0,w=0;const I=[!1,!1,!1],F=1e-4;for(this.Initialize(),i=0,h=0,g=1;g<=this.fNhull;g++)i+=this.fXN[this.fHullPoints[g-1]],h+=this.fYN[this.fHullPoints[g-1]];for(i=i/this.fNhull+F,h=h/this.fNhull+F,this.Interpolate(i,h),f=1;f<=this.fNdt;){for(T=this.fPTried[f-1],y=this.fNTried[f-1],u=this.fMTried[f-1],I[0]=!1,I[1]=!1,I[2]=!1,c=1;c<=this.fNdt;c++)c!==f&&(Y=this.fPTried[c-1],_=this.fNTried[c-1],x=this.fMTried[c-1],T===Y&&y===_||T===Y&&y===x||T===_&&y===x?I[0]=!0:T===Y&&u===_||T===Y&&u===x||T===_&&u===x?I[1]=!0:(y===Y&&u===_||y===Y&&u===x||y===_&&u===x)&&(I[2]=!0));for(E=1;E<=3;E++)I[E-1]||(1===E?(P=T,p=y,w=u):2===E?(P=T,p=u,w=y):3===E&&(P=y,p=u,w=T),s=(this.fXN[P]+this.fXN[p])/2,t=(this.fYN[P]+this.fYN[p])/2,o=this.fXN[P]-this.fXN[p],n=this.fYN[P]-this.fYN[p],m=n,X=-o,l=Math.sqrt(m*m+X*X),m/=l,X/=l,M=this.fXN[w]-s,a=this.fYN[w]-t,e=M*m+a*X,e>0&&(m=-m,X=-X),d=Math.abs(Math.max(F*s,F*t)),N=s+m*d,r=t+X*d,this.Interpolate(N,r));f++}}FindHull(){this.fHullPoints||(this.fHullPoints=new Array(this.fNpoints));let i=0;for(let h=1;h<=this.fNpoints;h++)this.InHull(h,h)||(i++,this.fHullPoints[i-1]=h);this.fNhull=i}InHull(i,h){let s,t,N,r,o,n,m,X,M,a,e,l,d,f,c,T,y,u,Y,_,x,P=!1;const p=this.fXN[i],E=this.fYN[i];for(o=this.fNhull>0?this.fNhull:this.fNpoints,s=1,t=2,s===h?(s=t,t++):t===h&&t++,M=p-this.fXN[s],l=E-this.fYN[s],a=p-this.fXN[t],d=E-this.fYN[t],Y=Math.atan2(l,M),_=Math.atan2(d,a),x=Y-_-Math.floor((Y-_)/(2*Math.PI))*Math.PI*2,x<0&&(x+=2*Math.PI),n=x,N=1;N<=o;N++)if(r=this.fNhull>0?this.fHullPoints[N-1]:N,r!==s&&r!==t&&r!==h&&(M=p-this.fXN[s],l=E-this.fYN[s],a=p-this.fXN[t],d=E-this.fYN[t],e=p-this.fXN[r],f=E-this.fYN[r],m=a*l-M*d,X=M*d-a*l,m*X!=0&&(c=(a*f-e*d)/m,T=(M*f-e*l)/X,c<0||T<0))){if(y=(M*e+l*f)/Math.sqrt(M*M+l*l),u=(a*e+d*f)/Math.sqrt(a*a+d*d),y>u?(s=r,Y=Math.atan2(f,e),_=Math.atan2(d,a)):(t=r,Y=Math.atan2(l,M),_=Math.atan2(f,e)),x=Y-_-Math.floor((Y-_)/(2*Math.PI))*Math.PI*2,x<0&&(x+=2*Math.PI),(x-Math.PI)*(n-Math.PI)<0)return P=!0,P;n=x}return P}InterpolateOnPlane(i,h,s,t){let N,r,o=i,n=h,m=s;do{r=!1,n>o&&(N=o,o=n,n=N,r=!0),m>n&&(N=n,n=m,m=N,r=!0)}while(r);const X=this.fXN[o],M=this.fXN[n],a=this.fXN[m],e=this.fYN[o],l=this.fYN[n],d=this.fYN[m],f=this.fZ[o-1],c=this.fZ[n-1],T=this.fZ[m-1],y=(f*(l-d)+c*(d-e)+T*(e-l))/(X*(l-d)+M*(d-e)+a*(e-l)),u=(f*(M-a)+c*(a-X)+T*(X-M))/(e*(M-a)+l*(a-X)+d*(X-M));return y*this.fXN[t]+u*this.fYN[t]+(f-y*X-u*e)}Interpolate(i,h){let s,t,N,r,o,n,m,X,M,a,e,l,d,f,c,T,y,u,Y,_,w,I,F,b,S,j,H,et,ft,ht,rt,U,q,nt,at,L,B,Q,G,R,J,lt,ot,x=0,P=0,p=0,E=0,g=0;const Z=[0,0,0],k=[0,0,0];if(this.Initialize(),this.fOrder||(this.fOrder=new Array(this.fNpoints),this.fDist=new Array(this.fNpoints)),this.fXN[0]=i,this.fYN[0]=h,s=this.fZout,N=0,i>this.fXNmax||i<this.fXNmin||h>this.fYNmax||h<this.fYNmin)return s;for(t=1;t<=this.fNdt;t++)if(r=this.fPTried[t-1],o=this.fNTried[t-1],n=this.fMTried[t-1],this.Enclose(r,o,n,0))return s=this.InterpolateOnPlane(r,o,n,0),s;const Nt=this.InHull(0,-1);if(!Nt)return s;for(t=1;t<=this.fNpoints;t++)w=this.fXN[t],I=this.fYN[t],this.fDist[t-1]=Math.sqrt((i-w)*(i-w)+(h-I)*(h-I));for(function mt(z,i,h){const s=new Array(z);for(let t=0;t<z;++t)s[t]={v:i[t],i:t};s.sort((t,N)=>t.v<N.v?-1:t.v>N.v?1:0);for(let t=0;t<z;++t)h[t]=s[t].i}(this.fNpoints,this.fDist,this.fOrder),t=0;t<this.fNpoints;t++)this.fOrder[t]++;for(M=3;M<=this.fNpoints;M++)for(n=this.fOrder[M-1],X=2;X<=M-1;X++)for(o=this.fOrder[X-1],m=1;m<=X-1;m++){let A=!1;if(r=this.fOrder[m-1],N>this.fMaxIter)return s;if(N++,F=Math.sqrt((this.fXN[r]-this.fXN[o])**2+(this.fYN[r]-this.fYN[o])**2),b=Math.sqrt((this.fXN[r]-this.fXN[n])**2+(this.fYN[r]-this.fYN[n])**2),S=Math.sqrt((this.fXN[o]-this.fXN[n])**2+(this.fYN[o]-this.fYN[n])**2),!(F+b<=S||F+S<=b||b+S<=F)&&this.Enclose(r,o,n,0)){for(x=0,e=1;e<=this.fNpoints;e++)if(e!==r&&e!==o&&e!==n){for(a=1;a<=this.fNpoints;a++)if(this.fOrder[a-1]===e){if(!(a<m||a<X||a<M))break;if(this.Enclose(r,o,n,e)){A=!0;break}}if(A)break;if((this.fXN[r]-this.fXN[e])*(this.fYN[r]-this.fYN[o])==(this.fYN[r]-this.fYN[e])*(this.fXN[r]-this.fXN[o])?(T=r,y=o):(this.fXN[r]-this.fXN[e])*(this.fYN[r]-this.fYN[n])==(this.fYN[r]-this.fYN[e])*(this.fXN[r]-this.fXN[n])?(T=r,y=n):(this.fXN[o]-this.fXN[e])*(this.fYN[o]-this.fYN[n])==(this.fYN[o]-this.fYN[e])*(this.fXN[o]-this.fXN[n])?(T=o,y=n):(T=0,y=0),0!==T){if(this.fXN[T]!==this.fXN[y]){if((this.fXN[e]-this.fXN[T])*(this.fXN[e]-this.fXN[y])<0){A=!0;break}(this.fXN[e]-this.fXN[T])*(this.fXN[e]-this.fXN[y])==0&&console.warn(`Interpolate Two of these three points are coincident ${T} ${y} ${e}`)}else{if((this.fYN[e]-this.fYN[T])*(this.fYN[e]-this.fYN[y])<0){A=!0;break}(this.fYN[e]-this.fYN[T])*(this.fYN[e]-this.fYN[y])==0&&console.warn(`Interpolate Two of these three points are coincident ${T} ${y} ${e}`)}continue}if(A)break;for(l=n,f=r,c=o,Z[0]=this.fXN[r]-this.fXN[e],k[0]=this.fYN[r]-this.fYN[e],Z[1]=this.fXN[o]-this.fXN[e],k[1]=this.fYN[o]-this.fYN[e],Z[2]=this.fXN[n]-this.fXN[e],k[2]=this.fYN[n]-this.fYN[e],a=1;a<=3;a++)if(L=Z[a-1],B=Z[a%3],Q=Z[(a+1)%3],G=k[a-1],R=k[a%3],J=k[(a+1)%3],lt=(J*B-Q*R)*(G*B-L*R),ot=(J*L-Q*G)*(R*L-B*G),lt>=0&&ot>=0){1===a?(l=n,f=r,c=o):2===a?(l=r,f=o,c=n):(l=o,f=n,c=r);break}if(q=((this.fXN[l]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[l]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))/Math.sqrt(((this.fXN[l]-this.fXN[f])*(this.fXN[l]-this.fXN[f])+(this.fYN[l]-this.fYN[f])*(this.fYN[l]-this.fYN[f]))*((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))),nt=((this.fXN[c]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[c]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))/Math.sqrt(((this.fXN[c]-this.fXN[f])*(this.fXN[c]-this.fXN[f])+(this.fYN[c]-this.fYN[f])*(this.fYN[c]-this.fYN[f]))*((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f]))),at=((this.fXN[c]-this.fXN[f])*(this.fXN[l]-this.fXN[f])+(this.fYN[c]-this.fYN[f])*(this.fYN[l]-this.fYN[f]))/Math.sqrt(((this.fXN[c]-this.fXN[f])*(this.fXN[c]-this.fXN[f])+(this.fYN[c]-this.fYN[f])*(this.fYN[c]-this.fYN[f]))*((this.fXN[l]-this.fXN[f])*(this.fXN[l]-this.fXN[f])+(this.fYN[l]-this.fYN[f])*(this.fYN[l]-this.fYN[f]))),!(q>nt||q>at)){if(et=Math.sqrt((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[f])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[f])),ft=Math.sqrt((this.fXN[e]-this.fXN[c])*(this.fXN[e]-this.fXN[c])+(this.fYN[e]-this.fYN[c])*(this.fYN[e]-this.fYN[c])),ht=Math.sqrt((this.fXN[l]-this.fXN[f])*(this.fXN[l]-this.fXN[f])+(this.fYN[l]-this.fYN[f])*(this.fYN[l]-this.fYN[f])),rt=Math.sqrt((this.fXN[l]-this.fXN[c])*(this.fXN[l]-this.fXN[c])+(this.fYN[l]-this.fYN[c])*(this.fYN[l]-this.fYN[c])),j=((this.fXN[e]-this.fXN[f])*(this.fXN[e]-this.fXN[c])+(this.fYN[e]-this.fYN[f])*(this.fYN[e]-this.fYN[c]))/et/ft,H=((this.fXN[l]-this.fXN[f])*(this.fXN[l]-this.fXN[c])+(this.fYN[l]-this.fYN[f])*(this.fYN[l]-this.fYN[c]))/ht/rt,U=j*Math.sqrt(1-H*H)+H*Math.sqrt(1-j*j),U<-1e-6){A=!0;break}Math.abs(U)<=1e-6&&(x++,P=e,p=l,E=f,g=c)}}if(!A)return x>0?(d=P,l=p,f=E,c=g,this.fZ[f-1]+this.fZ[c-1]>this.fZ[d-1]+this.fZ[l-1]?(u=r,Y=o,_=n,this.FileIt(r,o,n),this.FileIt(d,f,c)):(u=l,Y=d,_=this.Enclose(l,d,f,0)?f:c,this.FileIt(l,d,f),this.FileIt(l,d,c))):(this.FileIt(r,o,n),u=r,Y=o,_=n),s=this.InterpolateOnPlane(u,Y,_,0),s}}return Nt&&console.error(`Interpolate Point outside hull when expected inside: this point could be dodgy ${i}  ${h} ${N}`),s}SetMaxIter(i=1e5){this.fAllTri=!1,this.fMaxIter=i}SetMarginBinsContent(i){this.fZout=i}}function $(z){let i=Math.floor(z.index/this.nvertex);if(i<0||i>=this.index.length)return null;const h=n=>n*n;i=this.index[i];const s=this.fp,t=this.graph;let N=s.grx(t.fX[i]),r=s.gry(t.fY[i]),o=s.grz(t.fZ[i]);if(this.check_next&&i+1<t.fX.length){const n=z.point,m=s.grx(t.fX[i+1]),X=s.gry(t.fY[i+1]),M=s.grz(t.fZ[i+1]);h(n.x-m)+h(n.y-X)+h(n.z-M)<h(n.x-N)+h(n.y-r)+h(n.z-o)&&(N=m,r=X,o=M,i++)}return{x1:N-this.scale0,x2:N+this.scale0,y1:r-this.scale0,y2:r+this.scale0,z1:o-this.scale0,z2:o+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+i,"x: "+s.axisAsText("x",t.fX[i]),"y: "+s.axisAsText("y",t.fY[i]),"z: "+s.axisAsText("z",t.fZ[i])]}}class K extends dt.JW{decodeOptions(i,h){const s=new ct.nC(i);this.options||(this.options={});const t=this.options;s.check("SAME"),t.Triangles=s.check("TRI1")?11:s.check("TRI2")?10:s.check("TRIW")||s.check("TRI")?1:0,t.Line=s.check("LINE"),t.Error=s.check("ERR")&&(this.matchObjectType(D.clTGraph2DErrors)||this.matchObjectType(D.clTGraph2DAsymmErrors)),s.check("P0COL")?t.Color=t.Circles=t.Markers=!0:(t.Color=s.check("COL"),t.Circles=s.check("P0"),t.Markers=s.check("P")),t.Markers||(t.Color=!1),(t.Color||t.Triangles>=10)&&(t.Zscale=s.check("Z")),t.isAny=function(){return this.Markers||this.Error||this.Circles||this.Line||this.Triangles},t.isAny()?(t.Axis="lego2",t.Zscale&&(t.Axis+="z")):t.Axis=i,this.storeDrawOpt(i)}createHistogram(){const i=this.getObject(),h=this.matchObjectType(D.clTGraph2DAsymmErrors);let s=i.fX[0],t=s,N=i.fY[0],r=N,o=i.fZ[0],n=o;for(let Y=0;Y<i.fNpoints;++Y){const _=i.fX[Y],x=i.fY[Y],P=i.fZ[Y];this.options.Error?(s=Math.min(s,_-(h?i.fEXlow[Y]:i.fEX[Y])),t=Math.max(t,_+(h?i.fEXhigh[Y]:i.fEX[Y])),N=Math.min(N,x-(h?i.fEYlow[Y]:i.fEY[Y])),r=Math.max(r,x+(h?i.fEYhigh[Y]:i.fEY[Y])),o=Math.min(o,P-(h?i.fEZlow[Y]:i.fEZ[Y])),n=Math.max(n,P+(h?i.fEZhigh[Y]:i.fEZ[Y]))):(s=Math.min(s,_),t=Math.max(t,_),N=Math.min(N,x),r=Math.max(r,x),o=Math.min(o,P),n=Math.max(n,P))}function m(Y,_,x){return Y<_?x*(_-Y):Math.abs(Y)<1e5?.02:.02*Math.abs(Y)}const X=m(s,t,i.fMargin),M=m(N,r,i.fMargin),a=m(o,n,0);let e=s-X,l=t+X,d=N-M,f=r+M,c=o-a,T=n+a;e<0&&s>=0&&(e=.98*s),l>0&&t<=0&&(l=0),d<0&&N>=0&&(d=.98*N),f>0&&r<=0&&(f=0),c<0&&o>=0&&(c=.98*o),T>0&&n<=0&&(T=0);const y=this.getObject();y.fMinimum!==D.kNoZoom&&(c=y.fMinimum),y.fMaximum!==D.kNoZoom&&(T=y.fMaximum),this._own_histogram=!0;const u=(0,D.createHistogram)(D.clTH2F,y.fNpx,y.fNpy);if(u.fName=y.fName+"_h",(0,D.setHistogramTitle)(u,y.fTitle),u.fXaxis.fXmin=e,u.fXaxis.fXmax=l,u.fYaxis.fXmin=d,u.fYaxis.fXmax=f,u.fZaxis.fXmin=c,u.fZaxis.fXmax=T,u.fMinimum=c,u.fMaximum=T,u.fBits|=D.kNoStats,!this.options.isAny()){const Y=this.buildDelaunay(y);if(Y)for(let _=0;_<y.fNpx;++_){const x=e+(_+.5)/y.fNpx*(l-e);for(let P=0;P<y.fNpy;++P){const E=Y.ComputeZ(x,d+(P+.5)/y.fNpy*(f-d));u.fArray[u.getBin(_+1,P+1)]=E}}}return u}buildDelaunay(i){return this._delaunay||(this._delaunay=new Yt(i),this._delaunay.FindAllTriangles(),this._delaunay.fNdt||delete this._delaunay),this._delaunay}drawTriangles(i,h,s,t){const N=this.buildDelaunay(h);if(!N)return;const r=i.logz?X=>X<i.scale_zmin?-.1:i.grz(X):i.grz,o=this.options.Triangles>=10,n=this.options.Triangles%10==1,m=new Xt.N7(s,r,0,2*i.size_z3d,n);for(m.loop=0;m.loop<2;++m.loop){m.createBuffers();for(let X=0;X<N.fNdt;++X){const M=[N.fPTried[X],N.fNTried[X],N.fMTried[X]],a=[];let e=!0;for(let l=0;l<3;++l){const d=M[l]-1;a.push(i.grx(h.fX[d]),i.gry(h.fY[d]),r(h.fZ[d])),(h.fX[d]<i.scale_xmin||h.fX[d]>i.scale_xmax||h.fY[d]<i.scale_ymin||h.fY[d]>i.scale_ymax)&&(e=!1)}o&&e&&m.addMainTriangle(...a),n&&e&&(m.addLineSegment(a[0],a[1],a[2],a[3],a[4],a[5]),m.addLineSegment(a[3],a[4],a[5],a[6],a[7],a[8]),m.addLineSegment(a[6],a[7],a[8],a[0],a[1],a[2]))}}m.callFuncs((X,M)=>{const a=(0,tt.cD)(this.getMainPainter(),M,null,100,100),e=t.calcColor(X,s.length),l=new C.V9B((0,v.Bx)(e,{side:C.$EB,vertexColors:!1})),d=new C.eaF(a,l);i.add3DMesh(d,this),d.painter=this},(X,M)=>{const a=this.getColor(h.fLineColor),e=new C.mrM({color:new C.Q1f(a),linewidth:h.fLineWidth}),l=(0,v.Fc)((0,tt.QK)(this.getMainPainter(),M,100,100),e);i.add3DMesh(l,this)})}updateObject(i,h){if(!this.matchObjectType(i))return!1;if(h&&h!==this.options.original&&this.decodeOptions(h,i),Object.assign(this.getObject(),i),delete this._delaunay,delete this.$redraw_hist,this.axes_draw){const s=this.getMainPainter();s?.updateObject(this.createHistogram(),this.options.Axis),this.$redraw_hist=s}return!0}redraw(){var i=this;return(0,W.A)(function*(){let h=Promise.resolve(!0);return i.$redraw_hist&&(h=i.$redraw_hist.redraw(),delete i.$redraw_hist),h.then(()=>i.drawGraph2D())})()}drawGraph2D(){var i=this;return(0,W.A)(function*(){const h=i.getMainPainter(),s=i.getFramePainter(),t=i.getObject();if(!(t&&h&&s&&s.mode3d))return i;if(s.remove3DMeshes(i),!i.options.isAny()){if(h.draw_content)return i;1===t.fMarkerSize&&1===t.fMarkerStyle?i.options.Circles=!0:i.options.Markers=!0}const N=(a,e)=>{let l=0;for(let d=0;d<t.fNpoints;++d)t.fX[d]<s.scale_xmin||t.fX[d]>s.scale_xmax||t.fY[d]<s.scale_ymin||t.fY[d]>s.scale_ymax||t.fZ[d]<a||t.fZ[d]>=e||++l;return l};let r=1;if(D.settings.OptimizeDraw>0&&!s.webgl){const a=N(s.scale_zmin,s.scale_zmax),e=5e4;a>e&&(r=Math.floor(a/e),r<=2&&(r=2))}const o=i.createAttMarker({attr:t,std:!1}),n=[];let m=null,X=[s.scale_zmin,s.scale_zmax],M=s.size_x3d/100*o.getFullSize();i.options.Circles&&(M=.06*s.size_x3d),s.usesvg&&(M*=.3),M*=7*Math.max(s.size_x3d/s.getFrameWidth(),s.size_z3d/s.getFrameHeight()),(i.options.Color||i.options.Triangles)&&(X=h.getContourLevels(!0),m=h.getHistPalette()),i.options.Triangles&&i.drawTriangles(s,t,X,m);for(let a=0;a<X.length-1;++a){const e=Math.max(X[a],s.scale_zmin),l=Math.min(X[a+1],s.scale_zmax);if(e>=l)continue;const d=Math.floor(N(e,l)/r),f=new Int32Array(d);let c=null,T=0,y=0,u=null,Y=!1,_=null,x=0,P=0;(i.options.Markers||i.options.Circles)&&(c=new v._l(d,s.webgl,M/3)),i.options.Error&&(u=new Float32Array(6*d*3),Y=i.matchObjectType(D.clTGraph2DAsymmErrors)),i.options.Line&&(_=new Float32Array(6*(d-1)));for(let p=0;p<t.fNpoints;++p){if(t.fX[p]<s.scale_xmin||t.fX[p]>s.scale_xmax||t.fY[p]<s.scale_ymin||t.fY[p]>s.scale_ymax||t.fZ[p]<e||t.fZ[p]>=l||r>1&&(T=(T+1)%r,0!==T))continue;f[y++]=p;const E=s.grx(t.fX[p]),g=s.gry(t.fY[p]),w=s.grz(t.fZ[p]);c&&c.addPoint(E,g,w),u&&(u[x]=s.grx(t.fX[p]-(Y?t.fEXlow[p]:t.fEX[p])),u[x+1]=g,u[x+2]=w,u[x+3]=s.grx(t.fX[p]+(Y?t.fEXhigh[p]:t.fEX[p])),u[x+4]=g,u[x+5]=w,x+=6,u[x]=E,u[x+1]=s.gry(t.fY[p]-(Y?t.fEYlow[p]:t.fEY[p])),u[x+2]=w,u[x+3]=E,u[x+4]=s.gry(t.fY[p]+(Y?t.fEYhigh[p]:t.fEY[p])),u[x+5]=w,x+=6,u[x]=E,u[x+1]=g,u[x+2]=s.grz(t.fZ[p]-(Y?t.fEZlow[p]:t.fEZ[p])),u[x+3]=E,u[x+4]=g,u[x+5]=s.grz(t.fZ[p]+(Y?t.fEZhigh[p]:t.fEZ[p])),x+=6),_&&(P>=6&&(_[P]=_[P-3],_[P+1]=_[P-2],_[P+2]=_[P-1],P+=3),_[P]=E,_[P+1]=g,_[P+2]=w,P+=3)}if(_&&P>3&&_.length===P){const p=i.getColor(t.fLineColor),E=new C.mrM({color:new C.Q1f(p),linewidth:t.fLineWidth}),g=(0,v.Fc)(_,E);s.add3DMesh(g,i),g.graph=t,g.index=f,g.fp=s,g.scale0=.7*M,g.tip_name=i.getObjectHint(),g.tip_color=3===t.fMarkerColor?16711680:65280,g.nvertex=2,g.check_next=!0,g.tooltip=$}if(u){const p=i.getColor(t.fLineColor),E=new C.mrM({color:new C.Q1f(p),linewidth:t.fLineWidth}),g=(0,v.Fc)(u,E);s.add3DMesh(g,i),g.graph=t,g.index=f,g.fp=s,g.scale0=.7*M,g.tip_name=i.getObjectHint(),g.tip_color=3===t.fMarkerColor?16711680:65280,g.nvertex=6,g.tooltip=$}if(c){let p="blue";(!i.options.Circles||i.options.Color)&&(p=m?.calcColor(a,X.length)??i.getColor(t.fMarkerColor));const E=c.createPoints({color:p,style:i.options.Circles?4:t.fMarkerStyle}).then(g=>{g.graph=t,g.fp=s,g.tip_color=3===t.fMarkerColor?16711680:65280,g.scale0=.3*M,g.index=f,g.tip_name=i.getObjectHint(),g.tooltip=$,s.add3DMesh(g,i)});n.push(E)}}return Promise.all(n).then(()=>{if(i.options.Zscale&&i.axes_draw){const a=i.getMainPainter()?.findFunction(D.clTPaletteAxis);return i.getPadPainter()?.findPainterFor(a)?.drawPave()}}).then(()=>(s.render3D(100),i))})()}static draw(i,h,s){return(0,W.A)(function*(){const t=new K(i,h);t.decodeOptions(s,h);let N=Promise.resolve(null);return t.getMainPainter()||(N=ut.TH2Painter.draw(i,t.createHistogram(),t.options.Axis),t.axes_draw=!0),N.then(()=>(t.addToPadPrimitives(),t.drawGraph2D()))})()}}}}]);
//# sourceMappingURL=763.0049a9e724764c1d.js.map