"use strict";(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[653],{7653:(j,S,y)=>{y.r(S),y.d(S,{drawEllipse:()=>O,drawJSImage:()=>Y,drawMarker:()=>I,drawPie:()=>b,drawPolyMarker:()=>R,drawText:()=>k});var X=y(5072),$=y(8872),p=y(2843),T=y(5992),g=y(7900);function k(){return D.apply(this,arguments)}function D(){return(D=(0,X.A)(function*(){const t=this.getObject(),d=this.getPadPainter(),c=d.getPadWidth(),a=d.getPadHeight(),i=this.getFramePainter(),o=t.fName.startsWith("http://")||t.fName.startsWith("https://");let f=t.fX,r=t.fY,h=!1,e=1,s=this.matchObjectType($.clTAnnotation);if(this.createAttText({attr:t}),s&&i?.mode3d&&(0,$.isFunc)(i?.convert3DtoPadNDC)){const n=i.convert3DtoPadNDC(t.fX,t.fY,t.fZ);f=n.x,r=n.y,this.isndc=!0,s="3d"}else t.TestBit((0,$.BIT)(14))?this.isndc=!0:d.getRootPad(!0)?h=new p.nC(this.getDrawOpt()).check("FRAME"):(this.isndc=!0,f=r=.5,t.fTextAlign=22);this.createG(h?"frame2d":void 0,o),this.draw_g.attr("transform",null),this.pos_x=this.axisToSvg("x",f,this.isndc),this.pos_y=this.axisToSvg("y",r,this.isndc),this.swap_xy=h&&i?.swap_xy,this.swap_xy&&([this.pos_x,this.pos_y]=[this.pos_y,this.pos_x]);const x=this.textatt.createArg({x:this.pos_x,y:this.pos_y,text:t.fTitle,latex:0});return t._typename===$.clTLatex||s?(x.latex=1,e=.9):t._typename===$.clTMathText&&(x.latex=2,e=.8),o&&(this.draw_g.attr("href",t.fName),this.isBatchMode()||this.draw_g.append("svg:title").text(`link on ${t.fName}`)),this.startTextDrawingAsync(this.textatt.font,this.textatt.getSize(c,a,e,.05)).then(()=>this.drawText(x)).then(()=>this.finishTextDrawing()).then(()=>(this.isBatchMode()||(this.pos_dx=this.pos_dy=0,this.moveDrag||(this.moveDrag=function(n,l){this.pos_dx+=n,this.pos_dy+=l,(0,p.bk)(this.draw_g,this.pos_dx,this.pos_dy)}),this.moveEnd||(this.moveEnd=function(n){if(n)return;const l=this.getObject();let _=this.svgToAxis("x",this.pos_x+this.pos_dx,this.isndc),u=this.svgToAxis("y",this.pos_y+this.pos_dy,this.isndc);this.swap_xy&&([_,u]=[u,_]),l.fX=_,l.fY=u,this.submitCanvExec(`SetX(${_});;SetY(${u});;`)}),"3d"!==s?(0,T.X2)(this,!0,o):(i.processRender3D=!0,this.handleRender3D=()=>{const n=i.convert3DtoPadNDC(t.fX,t.fY,t.fZ),l=this.axisToSvg("x",n.x,!0),_=this.axisToSvg("y",n.y,!0);(0,p.bk)(this.draw_g,l-this.pos_x,_-this.pos_y)}),(0,g.wh)(this,g.Ew),this.fillContextMenuItems=function(n){n.add("Change text",()=>n.input("Enter new text",t.fTitle).then(l=>{t.fTitle=l,this.interactiveRedraw("pad",`exec:SetTitle("${l}")`)}))}),this))})).apply(this,arguments)}function O(){const t=this.getObject(),d=0===t.fPhimin&&360===t.fPhimax,c="TCrown"===t._typename;this.createAttLine({attr:t}),this.createAttFill({attr:t}),this.createG();const a=this.getAxisToSvgFunc(),i=a.x(t.fX1),o=a.y(t.fY1),f=c&&t.fR1<=0?a.x(t.fX1+t.fR2)-i:a.x(t.fX1+t.fR1)-i,r=o-a.y(t.fY1+t.fR2);let h="";if(c&&t.fR1>0){const e=f,s=r,x=o-a.y(t.fY1+t.fR1),n=a.x(t.fX1+t.fR2)-i;if(d)h=`M${-e},0A${e},${x},0,1,0,${e},0A${e},${x},0,1,0,${-e},0M${-n},0A${n},${s},0,1,0,${n},0A${n},${s},0,1,0,${-n},0`;else{const l=t.fPhimax-t.fPhimin>=180?1:0,_=t.fPhimin*Math.PI/180,u=t.fPhimax*Math.PI/180,w=Math.round(e*Math.cos(_)),P=Math.round(x*Math.sin(_));h=`M${Math.round(e*Math.cos(u))},${Math.round(x*Math.sin(u))}A${e},${x},0,${l},0,${w},${P}L${Math.round(n*Math.cos(_))},${Math.round(s*Math.sin(_))}A${n},${s},0,${l},1,${Math.round(n*Math.cos(u))},${Math.round(s*Math.sin(u))}Z`}}else if(0===t.fTheta)h=d?`M${-f},0A${f},${r},0,1,0,${f},0A${f},${r},0,1,0,${-f},0Z`:`M0,0L${Math.round(f*Math.cos(t.fPhimin*Math.PI/180))},${Math.round(r*Math.sin(t.fPhimin*Math.PI/180))}A${f},${r},0,1,1,${Math.round(f*Math.cos(t.fPhimax*Math.PI/180))},${Math.round(r*Math.sin(t.fPhimax*Math.PI/180))}Z`;else{const e=Math.cos(t.fTheta*Math.PI/180),s=Math.sin(t.fTheta*Math.PI/180),x=t.fPhimin*Math.PI/180,l=200,_=(t.fPhimax*Math.PI/180-x)/(l-(d?0:1));let u=0,w=0;d||(h="M0,0");for(let P=0;P<l;++P){const v=x+P*_,A=t.fR1*Math.cos(v),E=t.fR2*Math.sin(v),M=a.x(t.fX1+A*e-E*s)-i,m=a.y(t.fY1+A*s+E*e)-o;h?h+=u===M?"v"+(m-w):w===m?"h"+(M-u):`l${M-u},${m-w}`:h=`M${M},${m}`,u=M,w=m}h+="Z"}this.x=i,this.y=o,(0,p.bk)(this.draw_g.append("svg:path"),i,o).attr("d",h).call(this.lineatt.func).call(this.fillatt.func),(0,g.wh)(this,g.Ew),(0,T.X2)(this),this.moveDrag=function(e,s){this.x+=e,this.y+=s,(0,p.bk)(this.draw_g.select("path"),this.x,this.y)},this.moveEnd=function(e){if(e)return;const s=this.getObject();s.fX1=this.svgToAxis("x",this.x),s.fY1=this.svgToAxis("y",this.y),this.submitCanvExec(`SetX1(${s.fX1});;SetY1(${s.fY1});;Notify();;`)}}function b(){this.createG();const t=this.getObject(),d=t.fPieSlices.length,c=this.axisToSvg("x",t.fX),a=this.axisToSvg("y",t.fY),i=this.axisToSvg("x",t.fX+t.fRadius)-c,o=this.axisToSvg("y",t.fY+t.fRadius)-a;(0,p.bk)(this.draw_g,c,a);let f=0,r=t.fAngularOffset*Math.PI/180,h=Math.round(i*Math.cos(r)),e=Math.round(o*Math.sin(r));for(let s=0;s<d;s++)f+=t.fPieSlices[s].fValue;for(let s=0;s<d;s++){const x=t.fPieSlices[s];this.createAttLine({attr:x}),this.createAttFill({attr:x}),r+=x.fValue/f*2*Math.PI;const n=Math.round(i*Math.cos(r)),l=Math.round(o*Math.sin(r));this.draw_g.append("svg:path").attr("d",`M0,0L${h},${e}A${i},${o},0,0,0,${n},${l}z`).call(this.lineatt.func).call(this.fillatt.func),h=n,e=l}}function I(){const t=this.getObject(),d=(0,$.BIT)(14);this.isndc=t.TestBit(d);const c=!this.isndc&&new p.nC(this.getDrawOpt()).check("FRAME"),a=c&&this.getFramePainter()?.swap_xy;this.createAttMarker({attr:t}),this.createG(c?"frame2d":void 0);let i=this.axisToSvg("x",t.fX,this.isndc),o=this.axisToSvg("y",t.fY,this.isndc);a&&([i,o]=[o,i]);const f=this.markeratt.create(i,o);f&&this.draw_g.append("svg:path").attr("d",f).call(this.markeratt.func),(0,g.wh)(this,g.Ew),(0,T.X2)(this),this.dx=this.dy=0,this.moveDrag=function(r,h){this.dx+=r,this.dy+=h,(0,p.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(r){if(r)return;const h=this.getObject();let e=this.svgToAxis("x",this.axisToSvg("x",h.fX,this.isndc)+this.dx,this.isndc),s=this.svgToAxis("y",this.axisToSvg("y",h.fY,this.isndc)+this.dy,this.isndc);a&&([e,s]=[s,e]),h.fX=e,h.fY=s,this.submitCanvExec(`SetX(${e});;SetY(${s});;Notify();;`),this.redraw()}}function R(){const t=this.getObject(),d=this.getAxisToSvgFunc();this.createAttMarker({attr:t}),this.createG();let c="";for(let a=0;a<=t.fLastPoint;++a)c+=this.markeratt.create(d.x(t.fX[a]),d.y(t.fY[a]));c&&this.draw_g.append("svg:path").attr("d",c).call(this.markeratt.func),(0,g.wh)(this,g.Ew),(0,T.X2)(this),this.dx=this.dy=0,this.moveDrag=function(a,i){this.dx+=a,this.dy+=i,(0,p.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(a){if(a)return;const i=this.getObject(),o=this.getAxisToSvgFunc();let f="";for(let r=0;r<=i.fLastPoint;++r){const h=this.svgToAxis("x",o.x(i.fX[r])+this.dx),e=this.svgToAxis("y",o.y(i.fY[r])+this.dy);i.fX[r]=h,i.fY[r]=e,f+=`SetPoint(${r},${h},${e});;`}this.submitCanvExec(f+"Notify();;"),this.redraw()}}function Y(t,d,c){const a=new p.b8(t),i=a.selectDom(),o=i.append("img").attr("src",d.fName).attr("title",d.fTitle||d.fName);return c&&c.indexOf("scale")>=0?o.style("width","100%").style("height","100%"):c&&c.indexOf("center")>=0&&(i.style("position","relative"),o.attr("style","margin: 0; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);")),a.setTopPainter(),a}}}]);
//# sourceMappingURL=653.9a48fa22bb25f344.js.map